<!DOCTYPE html>
<html lang="pt-br" xml:lang="pt-br">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>14 AED de multivariadas | Curso básico de introdução à linguagem R</title>
  <meta name="description" content="Este livro é um guia básico para conhecer a sintaxe básica da linguagem de programação R e o potencial de utilizá-la como ferramenta científica." />
  <meta name="generator" content="bookdown 0.24.9 and GitBook 2.6.7" />

  <meta property="og:title" content="14 AED de multivariadas | Curso básico de introdução à linguagem R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Este livro é um guia básico para conhecer a sintaxe básica da linguagem de programação R e o potencial de utilizá-la como ferramenta científica." />
  <meta name="github-repo" content="LABOTAM/IntroR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="14 AED de multivariadas | Curso básico de introdução à linguagem R" />
  
  <meta name="twitter:description" content="Este livro é um guia básico para conhecer a sintaxe básica da linguagem de programação R e o potencial de utilizá-la como ferramenta científica." />
  

<meta name="author" content="Alberto Vicentini (INPA)" />
<meta name="author" content="Ricardo de Oliveira Perdiz - ricardoperdiz@yahoo.com" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="aed-bivar.html"/>
<link rel="next" href="base-tidyverse.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://github.com/LABOTAM/LABOTAM.github.io">Curso básico de introdução ao R</a></li>

<li class="divider"></li>
<li><a href="index.html#prefácio" id="toc-prefácio">Prefácio</a>
<ul>
<li><a href="index.html#estrutura-do-livro" id="toc-estrutura-do-livro">Estrutura do livro</a></li>
<li><a href="index.html#sobre-os-autores" id="toc-sobre-os-autores">Sobre os autores</a></li>
<li><a href="index.html#agradecimentos" id="toc-agradecimentos">Agradecimentos</a></li>
<li><a href="index.html#pré-requisitos" id="toc-pré-requisitos">Pré-requisitos</a></li>
<li><a href="index.html#caso-você-possua-um-computador" id="toc-caso-você-possua-um-computador">Caso você possua um computador</a>
<ul>
<li><a href="index.html#instale-o-r" id="toc-instale-o-r">Instale o R</a></li>
<li><a href="index.html#instale-um-ambiente-de-desenvolvimento-integrado---ide" id="toc-instale-um-ambiente-de-desenvolvimento-integrado---ide">Instale um ambiente de desenvolvimento integrado - IDE</a></li>
<li><a href="index.html#baixe-os-pacotes-abaixo" id="toc-baixe-os-pacotes-abaixo">Baixe os pacotes abaixo</a></li>
<li><a href="index.html#baixe-o-repositório-para-seu-computador" id="toc-baixe-o-repositório-para-seu-computador">Baixe o repositório para seu computador</a></li>
</ul></li>
<li><a href="index.html#caso-você-não-possua-um-computador" id="toc-caso-você-não-possua-um-computador">Caso você não possua um computador</a></li>
<li><a href="index.html#o-que-é-o-r-e-por-qual-razão-você-deve-se-preocupar-em-programar" id="toc-o-que-é-o-r-e-por-qual-razão-você-deve-se-preocupar-em-programar">O que é o R e por qual razão você deve se preocupar em programar</a>
<ul>
<li><a href="index.html#o-r-em-poucas-palavras" id="toc-o-r-em-poucas-palavras">O R em poucas palavras</a></li>
<li><a href="index.html#por-que-programar" id="toc-por-que-programar">Por que programar?</a></li>
</ul></li>
<li><a href="index.html#análise-exploratória-de-dados-aed" id="toc-análise-exploratória-de-dados-aed">Análise exploratória de dados (AED)</a>
<ul>
<li><a href="index.html#o-que-é-aed-e-por-que-fazer-aed" id="toc-o-que-é-aed-e-por-que-fazer-aed">O que é AED e por que fazer AED?</a></li>
<li><a href="index.html#objetivos-da-aed" id="toc-objetivos-da-aed">Objetivos da AED</a></li>
<li><a href="index.html#para-ler" id="toc-para-ler">Para ler</a></li>
</ul></li>
<li><a href="index.html#exercícios-no-notar" id="toc-exercícios-no-notar">Exercícios no <strong>notaR</strong></a>
<ul>
<li><a href="index.html#conhecendo-o-notar" id="toc-conhecendo-o-notar">Conhecendo o <strong>notaR</strong></a></li>
</ul></li>
<li><a href="index.html#referências-úteis" id="toc-referências-úteis">Referências úteis</a></li>
</ul></li>
<li><a href="#part-parte-i" id="toc-part-parte-i">(PART) Parte I</a></li>
<li><a href="intro.html#intro" id="toc-intro"><span class="toc-section-number">1</span> Conceitos introdutórios</a>
<ul>
<li><a href="intro.html#console-e-scripts" id="toc-console-e-scripts"><span class="toc-section-number">1.1</span> Console e scripts</a></li>
<li><a href="intro.html#linguagem-objeto-orientada" id="toc-linguagem-objeto-orientada"><span class="toc-section-number">1.2</span> Linguagem objeto-orientada</a></li>
<li><a href="intro.html#base-pacotes" id="toc-base-pacotes"><span class="toc-section-number">1.3</span> R-base e pacotes</a></li>
<li><a href="intro.html#help" id="toc-help"><span class="toc-section-number">1.4</span> Ajuda no R</a></li>
<li><a href="intro.html#área-de-trabalho-vs.-pasta-de-trabalho" id="toc-área-de-trabalho-vs.-pasta-de-trabalho"><span class="toc-section-number">1.5</span> Área de trabalho vs. Pasta de Trabalho</a></li>
<li><a href="intro.html#dicas-de-organização-do-trabalho" id="toc-dicas-de-organização-do-trabalho"><span class="toc-section-number">1.6</span> Dicas de organização do trabalho</a></li>
<li><a href="intro.html#dicas-de-erros-comuns-de-sintaxe-da-linguagem-r" id="toc-dicas-de-erros-comuns-de-sintaxe-da-linguagem-r"><span class="toc-section-number">1.7</span> Dicas de erros comuns de sintaxe da linguagem R</a>
<ul>
<li><a href="intro.html#parênteses" id="toc-parênteses"><span class="toc-section-number">1.7.1</span> Parênteses</a></li>
<li><a href="intro.html#vírgulas" id="toc-vírgulas"><span class="toc-section-number">1.7.2</span> Vírgulas</a></li>
<li><a href="intro.html#aspas" id="toc-aspas"><span class="toc-section-number">1.7.3</span> Aspas</a></li>
<li><a href="intro.html#números" id="toc-números"><span class="toc-section-number">1.7.4</span> Números</a></li>
<li><a href="intro.html#nomes-de-objetos" id="toc-nomes-de-objetos"><span class="toc-section-number">1.7.5</span> Nomes de objetos</a></li>
<li><a href="intro.html#atribuição-de-objetos" id="toc-atribuição-de-objetos"><span class="toc-section-number">1.7.6</span> Atribuição de objetos</a></li>
<li><a href="intro.html#busque-entender-as-partes" id="toc-busque-entender-as-partes"><span class="toc-section-number">1.7.7</span> Busque entender as partes</a></li>
</ul></li>
<li><a href="intro.html#o-r-como-calculadora" id="toc-o-r-como-calculadora"><span class="toc-section-number">1.8</span> O R como calculadora</a>
<ul>
<li><a href="intro.html#operadores" id="toc-operadores"><span class="toc-section-number">1.8.1</span> Operadores</a></li>
<li><a href="intro.html#precedência-de-parênteses" id="toc-precedência-de-parênteses"><span class="toc-section-number">1.8.2</span> Precedência de parênteses</a></li>
<li><a href="intro.html#funções-e-constantes-matemáticas" id="toc-funções-e-constantes-matemáticas"><span class="toc-section-number">1.8.3</span> Funções e constantes matemáticas</a></li>
<li><a href="intro.html#valor-na" id="toc-valor-na"><span class="toc-section-number">1.8.4</span> NA e valores afins</a></li>
</ul></li>
<li><a href="intro.html#exercícios" id="toc-exercícios"><span class="toc-section-number">1.9</span> Exercícios</a></li>
</ul></li>
<li><a href="vetores.html#vetores" id="toc-vetores"><span class="toc-section-number">2</span> Objeto I - Vetores</a>
<ul>
<li><a href="vetores.html#vetores-e-operações-vetoriais-i" id="toc-vetores-e-operações-vetoriais-i"><span class="toc-section-number">2.1</span> Vetores e operações vetoriais I</a>
<ul>
<li><a href="vetores.html#criação-de-vetores" id="toc-criação-de-vetores"><span class="toc-section-number">2.1.1</span> Criação de Vetores</a></li>
<li><a href="vetores.html#sequências-numéricas-repetições" id="toc-sequências-numéricas-repetições"><span class="toc-section-number">2.1.2</span> Sequências Numéricas &amp; Repetições</a></li>
</ul></li>
<li><a href="vetores.html#operações-matemáticas-com-vetores" id="toc-operações-matemáticas-com-vetores"><span class="toc-section-number">2.2</span> Operações Matemáticas com Vetores</a></li>
<li><a href="vetores.html#funções-com-vetores" id="toc-funções-com-vetores"><span class="toc-section-number">2.3</span> Funções com Vetores</a></li>
<li><a href="vetores.html#classes" id="toc-classes"><span class="toc-section-number">2.4</span> Classes de vetores e fatores</a></li>
<li><a href="vetores.html#indexacao" id="toc-indexacao"><span class="toc-section-number">2.5</span> Indexação</a>
<ul>
<li><a href="vetores.html#usando-índices-numéricos" id="toc-usando-índices-numéricos"><span class="toc-section-number">2.5.1</span> Usando índices numéricos</a></li>
<li><a href="vetores.html#usando-índices-de-nomes" id="toc-usando-índices-de-nomes"><span class="toc-section-number">2.5.2</span> Usando índices de nomes</a></li>
</ul></li>
<li><a href="vetores.html#vetor-operador-logico" id="toc-vetor-operador-logico"><span class="toc-section-number">2.6</span> Vetores e operadores lógicos</a>
<ul>
<li><a href="vetores.html#perg-vetores" id="toc-perg-vetores"><span class="toc-section-number">2.6.1</span> Fazendo perguntas à vetores</a></li>
<li><a href="vetores.html#vetor-filtro-logico" id="toc-vetor-filtro-logico"><span class="toc-section-number">2.6.2</span> Filtrando dados com vetores lógicos</a></li>
<li><a href="vetores.html#filtro-dados-ausentes" id="toc-filtro-dados-ausentes"><span class="toc-section-number">2.6.3</span> Perguntando por valores ausentes - NA</a></li>
</ul></li>
<li><a href="vetores.html#sabermais-vetores" id="toc-sabermais-vetores"><span class="toc-section-number">2.7</span> Para saber mais:</a></li>
<li><a href="vetores.html#exercícios-1" id="toc-exercícios-1"><span class="toc-section-number">2.8</span> Exercícios</a></li>
</ul></li>
<li><a href="mat-dframe.html#mat-dframe" id="toc-mat-dframe"><span class="toc-section-number">3</span> Objeto II - Matrizes e <code>data.frames</code></a>
<ul>
<li><a href="mat-dframe.html#matriz-vs.-data.frame" id="toc-matriz-vs.-data.frame"><span class="toc-section-number">3.1</span> Matriz vs. <code>data.frame</code></a>
<ul>
<li><a href="mat-dframe.html#criando-matrizes" id="toc-criando-matrizes"><span class="toc-section-number">3.1.1</span> Criando matrizes</a></li>
<li><a href="mat-dframe.html#criando-data.frames" id="toc-criando-data.frames"><span class="toc-section-number">3.1.2</span> Criando <code>data.frames</code></a></li>
<li><a href="mat-dframe.html#funções-importantes-na-manipulação-de-matrizes-e-data.frames" id="toc-funções-importantes-na-manipulação-de-matrizes-e-data.frames"><span class="toc-section-number">3.1.3</span> Funções importantes na manipulação de matrizes e <code>data.frames</code></a></li>
</ul></li>
<li><a href="mat-dframe.html#indexação-de-matriz-e-data.frame" id="toc-indexação-de-matriz-e-data.frame"><span class="toc-section-number">3.2</span> Indexação de matriz e <code>data.frame</code></a>
<ul>
<li><a href="mat-dframe.html#matrizes" id="toc-matrizes"><span class="toc-section-number">3.2.1</span> Matrizes</a></li>
<li><a href="mat-dframe.html#data.frame" id="toc-data.frame"><span class="toc-section-number">3.2.2</span> <code>data.frame</code></a></li>
</ul></li>
<li><a href="mat-dframe.html#filtrando-e-ordenando-matrizes-e-data.frames" id="toc-filtrando-e-ordenando-matrizes-e-data.frames"><span class="toc-section-number">3.3</span> Filtrando e ordenando matrizes e <code>data.frames</code></a>
<ul>
<li><a href="mat-dframe.html#filtragem-de-dados" id="toc-filtragem-de-dados"><span class="toc-section-number">3.3.1</span> Filtragem de dados</a></li>
<li><a href="mat-dframe.html#ordenação-de-dados" id="toc-ordenação-de-dados"><span class="toc-section-number">3.3.2</span> Ordenação de dados</a></li>
</ul></li>
<li><a href="mat-dframe.html#importando-e-exportando-dados-no-r" id="toc-importando-e-exportando-dados-no-r"><span class="toc-section-number">3.4</span> Importando e exportando dados no R</a>
<ul>
<li><a href="mat-dframe.html#arquivos-de-texto-simples-para-estocar-dados" id="toc-arquivos-de-texto-simples-para-estocar-dados"><span class="toc-section-number">3.4.1</span> Arquivos de texto simples para estocar dados</a></li>
<li><a href="mat-dframe.html#import-dados" id="toc-import-dados"><span class="toc-section-number">3.4.2</span> Importando dados</a></li>
<li><a href="mat-dframe.html#exportando-dados" id="toc-exportando-dados"><span class="toc-section-number">3.4.3</span> Exportando dados</a></li>
<li><a href="mat-dframe.html#outras-funções-úteis" id="toc-outras-funções-úteis"><span class="toc-section-number">3.4.4</span> Outras funções úteis</a></li>
</ul></li>
<li><a href="mat-dframe.html#sabermais-indexacao-matrizes-dframes" id="toc-sabermais-indexacao-matrizes-dframes"><span class="toc-section-number">3.5</span> Para saber mais:</a></li>
<li><a href="mat-dframe.html#exercícios-2" id="toc-exercícios-2"><span class="toc-section-number">3.6</span> Exercícios</a></li>
</ul></li>
<li><a href="lista-objcompl.html#lista-objcompl" id="toc-lista-objcompl"><span class="toc-section-number">4</span> Objeto III - Listas e objetos complexos</a>
<ul>
<li><a href="lista-objcompl.html#listas" id="toc-listas"><span class="toc-section-number">4.1</span> Listas</a></li>
<li><a href="lista-objcompl.html#obj-complexos" id="toc-obj-complexos"><span class="toc-section-number">4.2</span> Objetos complexos</a></li>
</ul></li>
<li><a href="func-graf.html#func-graf" id="toc-func-graf"><span class="toc-section-number">5</span> Funções gráficas</a>
<ul>
<li><a href="func-graf.html#dispositivos-gráficos" id="toc-dispositivos-gráficos"><span class="toc-section-number">5.1</span> Dispositivos Gráficos</a>
<ul>
<li><a href="func-graf.html#função-plot" id="toc-função-plot"><span class="toc-section-number">5.1.1</span> Função <code>plot()</code></a></li>
<li><a href="func-graf.html#dispositivos-de-tela" id="toc-dispositivos-de-tela"><span class="toc-section-number">5.1.2</span> Dispositivos de Tela</a></li>
<li><a href="func-graf.html#listar-e-controlar-dispositivos" id="toc-listar-e-controlar-dispositivos"><span class="toc-section-number">5.1.3</span> Listar e controlar dispositivos</a></li>
<li><a href="func-graf.html#dispositivos-de-arquivos" id="toc-dispositivos-de-arquivos"><span class="toc-section-number">5.1.4</span> Dispositivos de arquivos</a></li>
<li><a href="func-graf.html#figuras-vetoriais-em-pdf-ou-postscript" id="toc-figuras-vetoriais-em-pdf-ou-postscript"><span class="toc-section-number">5.1.5</span> Figuras vetoriais em <code>pdf</code> ou <code>postscript</code></a></li>
<li><a href="func-graf.html#figuras-raster" id="toc-figuras-raster"><span class="toc-section-number">5.1.6</span> Figuras raster</a></li>
</ul></li>
<li><a href="func-graf.html#par-graficos-p1" id="toc-par-graficos-p1"><span class="toc-section-number">5.2</span> Parâmetros gráficos, parte I - Margem, fonte, proporções</a>
<ul>
<li><a href="func-graf.html#margem-da-figura" id="toc-margem-da-figura"><span class="toc-section-number">5.2.1</span> Margem da figura</a></li>
<li><a href="func-graf.html#aspecto-dos-eixos" id="toc-aspecto-dos-eixos"><span class="toc-section-number">5.2.2</span> Aspecto dos eixos</a></li>
<li><a href="func-graf.html#proporção-dos-eixos" id="toc-proporção-dos-eixos"><span class="toc-section-number">5.2.3</span> Proporção dos eixos</a></li>
<li><a href="func-graf.html#múltiplas-figuras-na-mesma-tela-ou-página-com-mfrow-e-mfcol" id="toc-múltiplas-figuras-na-mesma-tela-ou-página-com-mfrow-e-mfcol"><span class="toc-section-number">5.2.4</span> Múltiplas figuras na mesma tela ou página com <code>mfrow()</code> e <code>mfcol()</code></a></li>
<li><a href="func-graf.html#múltiplas-figuras-na-mesma-image-usando-a-função-layout" id="toc-múltiplas-figuras-na-mesma-image-usando-a-função-layout"><span class="toc-section-number">5.2.5</span> Múltiplas figuras na mesma image usando a função <code>layout()</code></a></li>
</ul></li>
<li><a href="func-graf.html#par-graficos-p2" id="toc-par-graficos-p2"><span class="toc-section-number">5.3</span> Parâmetros gráficos, parte II - Símbolos e cores</a>
<ul>
<li><a href="func-graf.html#tipo-de-símbolo---pch" id="toc-tipo-de-símbolo---pch"><span class="toc-section-number">5.3.1</span> Tipo de símbolo - <code>pch</code></a></li>
<li><a href="func-graf.html#tamanho-dos-pontos---cex" id="toc-tamanho-dos-pontos---cex"><span class="toc-section-number">5.3.2</span> Tamanho dos pontos - <code>cex</code></a></li>
<li><a href="func-graf.html#linhas" id="toc-linhas"><span class="toc-section-number">5.3.3</span> Linhas</a></li>
<li><a href="func-graf.html#cores-de-símbolos---col-e-bg" id="toc-cores-de-símbolos---col-e-bg"><span class="toc-section-number">5.3.4</span> Cores de símbolos - <code>col</code> e <code>bg</code></a></li>
<li><a href="func-graf.html#funções-que-definem-cores" id="toc-funções-que-definem-cores"><span class="toc-section-number">5.3.5</span> Funções que definem cores</a></li>
</ul></li>
<li><a href="func-graf.html#graf-alto-nivel" id="toc-graf-alto-nivel"><span class="toc-section-number">5.4</span> Funções gráficas de alto nível</a>
<ul>
<li><a href="func-graf.html#plot---uma-função-genérica" id="toc-plot---uma-função-genérica"><span class="toc-section-number">5.4.1</span> <code>plot()</code> - uma função genérica</a></li>
<li><a href="func-graf.html#hist" id="toc-hist"><span class="toc-section-number">5.4.2</span> <code>hist()</code></a></li>
<li><a href="func-graf.html#boxplot" id="toc-boxplot"><span class="toc-section-number">5.4.3</span> <code>boxplot()</code></a></li>
<li><a href="func-graf.html#barplot" id="toc-barplot"><span class="toc-section-number">5.4.4</span> <code>barplot()</code></a></li>
<li><a href="func-graf.html#plot.phylo" id="toc-plot.phylo"><span class="toc-section-number">5.4.5</span> <code>plot.phylo()</code></a></li>
<li><a href="func-graf.html#image-e-countour" id="toc-image-e-countour"><span class="toc-section-number">5.4.6</span> <code>image()</code> e <code>countour()</code></a></li>
<li><a href="func-graf.html#map" id="toc-map"><span class="toc-section-number">5.4.7</span> <code>map()</code></a></li>
<li><a href="func-graf.html#xlim-e-ylim" id="toc-xlim-e-ylim"><span class="toc-section-number">5.4.8</span> <code>xlim</code> e <code>ylim</code></a></li>
</ul></li>
<li><a href="func-graf.html#graf-baixo-nivel" id="toc-graf-baixo-nivel"><span class="toc-section-number">5.5</span> Funções gráficas de baixo nível</a>
<ul>
<li><a href="func-graf.html#legend" id="toc-legend"><span class="toc-section-number">5.5.1</span> <code>legend()</code></a></li>
<li><a href="func-graf.html#points" id="toc-points"><span class="toc-section-number">5.5.2</span> <code>points()</code></a></li>
<li><a href="func-graf.html#text-e-mtext" id="toc-text-e-mtext"><span class="toc-section-number">5.5.3</span> <code>text()</code> e <code>mtext()</code></a></li>
<li><a href="func-graf.html#axis" id="toc-axis"><span class="toc-section-number">5.5.4</span> <code>axis()</code></a></li>
<li><a href="func-graf.html#abline" id="toc-abline"><span class="toc-section-number">5.5.5</span> <code>abline()</code></a></li>
<li><a href="func-graf.html#arrows-rect-polygon-e-segments" id="toc-arrows-rect-polygon-e-segments"><span class="toc-section-number">5.5.6</span> <code>arrows()</code>, <code>rect()</code>, <code>polygon()</code> e <code>segments()</code></a></li>
<li><a href="func-graf.html#symbols" id="toc-symbols"><span class="toc-section-number">5.5.7</span> <code>symbols()</code></a></li>
</ul></li>
<li><a href="func-graf.html#funções-gráficas-interativas" id="toc-funções-gráficas-interativas"><span class="toc-section-number">5.6</span> Funções gráficas interativas</a>
<ul>
<li><a href="func-graf.html#locator" id="toc-locator"><span class="toc-section-number">5.6.1</span> <code>locator()</code></a></li>
<li><a href="func-graf.html#identify" id="toc-identify"><span class="toc-section-number">5.6.2</span> <code>identify()</code></a></li>
</ul></li>
<li><a href="func-graf.html#sabermais-disp-grafico" id="toc-sabermais-disp-grafico"><span class="toc-section-number">5.7</span> Para saber mais:</a></li>
<li><a href="func-graf.html#exercícios-3" id="toc-exercícios-3"><span class="toc-section-number">5.8</span> Exercícios</a></li>
</ul></li>
<li><a href="iter-cflux.html#iter-cflux" id="toc-iter-cflux"><span class="toc-section-number">6</span> Iteração e controle de fluxo</a>
<ul>
<li><a href="iter-cflux.html#func-apply" id="toc-func-apply"><span class="toc-section-number">6.1</span> Funções da família <code>apply()</code></a>
<ul>
<li><a href="iter-cflux.html#em-uma-matriz" id="toc-em-uma-matriz"><span class="toc-section-number">6.1.1</span> Em uma matriz</a></li>
<li><a href="iter-cflux.html#em-um-vetor-ou-lista" id="toc-em-um-vetor-ou-lista"><span class="toc-section-number">6.1.2</span> Em um vetor ou lista</a></li>
<li><a href="iter-cflux.html#por-categoria-de-um-fator" id="toc-por-categoria-de-um-fator"><span class="toc-section-number">6.1.3</span> Por categoria de um fator</a></li>
</ul></li>
<li><a href="iter-cflux.html#condicionais" id="toc-condicionais"><span class="toc-section-number">6.2</span> Condicionais</a>
<ul>
<li><a href="iter-cflux.html#condicional-if" id="toc-condicional-if"><span class="toc-section-number">6.2.1</span> Condicional <code>if ()</code></a></li>
<li><a href="iter-cflux.html#condicional-if-com-o-else" id="toc-condicional-if-com-o-else"><span class="toc-section-number">6.2.2</span> Condicional <code>if ()</code> com o <code>else</code></a></li>
<li><a href="iter-cflux.html#condicional-ifelse" id="toc-condicional-ifelse"><span class="toc-section-number">6.2.3</span> Condicional <code>ifelse()</code></a></li>
</ul></li>
<li><a href="iter-cflux.html#iteracoes" id="toc-iteracoes"><span class="toc-section-number">6.3</span> Iterações</a>
<ul>
<li><a href="iter-cflux.html#iteração-com-for" id="toc-iteração-com-for"><span class="toc-section-number">6.3.1</span> Iteração com <code>for(){}</code></a></li>
<li><a href="iter-cflux.html#iteração-com-while" id="toc-iteração-com-while"><span class="toc-section-number">6.3.2</span> Iteração com <code>while(){}</code></a></li>
<li><a href="iter-cflux.html#iteração-com-for-e-a-condicional-if" id="toc-iteração-com-for-e-a-condicional-if"><span class="toc-section-number">6.3.3</span> Iteração com <code>for(){}</code> e a condicional <code>if(){}</code></a></li>
</ul></li>
<li><a href="iter-cflux.html#criando-ou-modificando-funções" id="toc-criando-ou-modificando-funções"><span class="toc-section-number">6.4</span> Criando ou modificando funções</a>
<ul>
<li><a href="iter-cflux.html#exemplo-i" id="toc-exemplo-i"><span class="toc-section-number">6.4.1</span> Exemplo I</a></li>
<li><a href="iter-cflux.html#exemplo-ii" id="toc-exemplo-ii"><span class="toc-section-number">6.4.2</span> Exemplo II</a></li>
</ul></li>
<li><a href="iter-cflux.html#sabermais-condic" id="toc-sabermais-condic"><span class="toc-section-number">6.5</span> Para saber mais:</a></li>
</ul></li>
<li><a href="sumar-dados.html#sumar-dados" id="toc-sumar-dados"><span class="toc-section-number">7</span> Sumarização de dados</a>
<ul>
<li><a href="sumar-dados.html#tabela-dinamica" id="toc-tabela-dinamica"><span class="toc-section-number">7.1</span> Tabelas dinâmicas</a></li>
<li><a href="sumar-dados.html#tabelas-de-contagem" id="toc-tabelas-de-contagem"><span class="toc-section-number">7.2</span> Tabelas de contagem</a></li>
<li><a href="sumar-dados.html#lógica-da-junção-de-tabelas" id="toc-lógica-da-junção-de-tabelas"><span class="toc-section-number">7.3</span> Lógica da junção de tabelas</a>
<ul>
<li><a href="sumar-dados.html#juncao-tbl-maneira1" id="toc-juncao-tbl-maneira1"><span class="toc-section-number">7.3.1</span> Maneira 1 - função <code>match()</code></a></li>
<li><a href="sumar-dados.html#maneira-2---índices-nominais" id="toc-maneira-2---índices-nominais"><span class="toc-section-number">7.3.2</span> Maneira 2 - índices nominais</a></li>
</ul></li>
<li><a href="sumar-dados.html#junção-de-tabelas-utilizando-funções" id="toc-junção-de-tabelas-utilizando-funções"><span class="toc-section-number">7.4</span> Junção de tabelas utilizando funções</a>
<ul>
<li><a href="sumar-dados.html#dados-para-nossa-prática" id="toc-dados-para-nossa-prática"><span class="toc-section-number">7.4.1</span> Dados para nossa prática</a></li>
<li><a href="sumar-dados.html#maneira-3---função-merge" id="toc-maneira-3---função-merge"><span class="toc-section-number">7.4.2</span> Maneira 3 - função <code>merge()</code></a></li>
</ul></li>
<li><a href="sumar-dados.html#para-saber-mais" id="toc-para-saber-mais"><span class="toc-section-number">7.5</span> Para saber mais</a></li>
<li><a href="sumar-dados.html#exercícios-4" id="toc-exercícios-4"><span class="toc-section-number">7.6</span> Exercícios</a></li>
</ul></li>
<li><a href="manip-txt-arq-pasta.html#manip-txt-arq-pasta" id="toc-manip-txt-arq-pasta"><span class="toc-section-number">8</span> Manipulação de textos, arquivos e pastas</a>
<ul>
<li><a href="manip-txt-arq-pasta.html#funções-para-manipulação-e-busca-de-textos" id="toc-funções-para-manipulação-e-busca-de-textos"><span class="toc-section-number">8.1</span> Funções para manipulação e busca de textos</a>
<ul>
<li><a href="manip-txt-arq-pasta.html#colar-ou-concatenar-textos" id="toc-colar-ou-concatenar-textos"><span class="toc-section-number">8.1.1</span> Colar ou concatenar textos</a></li>
<li><a href="manip-txt-arq-pasta.html#quebrar-ou-desconcatenar-textos" id="toc-quebrar-ou-desconcatenar-textos"><span class="toc-section-number">8.1.2</span> Quebrar ou desconcatenar textos</a></li>
<li><a href="manip-txt-arq-pasta.html#altera-caixa-do-texto" id="toc-altera-caixa-do-texto"><span class="toc-section-number">8.1.3</span> Altera caixa do texto</a></li>
<li><a href="manip-txt-arq-pasta.html#remove-espaços-em-branco" id="toc-remove-espaços-em-branco"><span class="toc-section-number">8.1.4</span> Remove espaços em branco</a></li>
<li><a href="manip-txt-arq-pasta.html#substitui-ou-pega-parte-de-texto" id="toc-substitui-ou-pega-parte-de-texto"><span class="toc-section-number">8.1.5</span> Substitui ou pega parte de texto</a></li>
<li><a href="manip-txt-arq-pasta.html#expressões-regulares" id="toc-expressões-regulares"><span class="toc-section-number">8.1.6</span> Expressões Regulares</a></li>
<li><a href="manip-txt-arq-pasta.html#remove-acentos" id="toc-remove-acentos"><span class="toc-section-number">8.1.7</span> Remove Acentos</a></li>
<li><a href="manip-txt-arq-pasta.html#metacaracteres" id="toc-metacaracteres"><span class="toc-section-number">8.1.8</span> Metacaracteres</a></li>
<li><a href="manip-txt-arq-pasta.html#classes-caracteres" id="toc-classes-caracteres"><span class="toc-section-number">8.1.9</span> Classes de caracteres</a></li>
<li><a href="manip-txt-arq-pasta.html#barra-invertida" id="toc-barra-invertida"><span class="toc-section-number">8.1.10</span> Barra invertida <code>\</code></a></li>
</ul></li>
<li><a href="manip-txt-arq-pasta.html#manipulação-de-pastas-e-arquivos" id="toc-manipulação-de-pastas-e-arquivos"><span class="toc-section-number">8.2</span> Manipulação de pastas e arquivos</a></li>
<li><a href="manip-txt-arq-pasta.html#sabermais-manip-txt-arqs-fld" id="toc-sabermais-manip-txt-arqs-fld"><span class="toc-section-number">8.3</span> Para saber mais:</a></li>
</ul></li>
<li><a href="amost-aleat.html#amost-aleat" id="toc-amost-aleat"><span class="toc-section-number">9</span> Amostragens aleatórias</a>
<ul>
<li><a href="amost-aleat.html#funções-para-gerar-permutações-e-simular-dados" id="toc-funções-para-gerar-permutações-e-simular-dados"><span class="toc-section-number">9.1</span> Funções para gerar permutações e simular dados</a></li>
<li><a href="amost-aleat.html#distribuições-aleatórias" id="toc-distribuições-aleatórias"><span class="toc-section-number">9.2</span> Distribuições aleatórias</a>
<ul>
<li><a href="amost-aleat.html#distribuição-normal" id="toc-distribuição-normal"><span class="toc-section-number">9.2.1</span> Distribuição Normal</a></li>
</ul></li>
<li><a href="amost-aleat.html#sabermais-distribuicoes" id="toc-sabermais-distribuicoes"><span class="toc-section-number">9.3</span> Para saber mais:</a></li>
<li><a href="amost-aleat.html#exercícios-5" id="toc-exercícios-5"><span class="toc-section-number">9.4</span> Exercícios</a></li>
</ul></li>
<li><a href="extr-dados.html#extr-dados" id="toc-extr-dados"><span class="toc-section-number">10</span> Extraindo dados de colunas descritivas</a>
<ul>
<li><a href="extr-dados.html#dados-categóricos" id="toc-dados-categóricos"><span class="toc-section-number">10.1</span> Dados categóricos</a>
<ul>
<li><a href="extr-dados.html#passo-01---lista-de-referência" id="toc-passo-01---lista-de-referência"><span class="toc-section-number">10.1.1</span> Passo 01 - Lista de referência</a></li>
<li><a href="extr-dados.html#passo-02---funções-que-fazem-a-busca" id="toc-passo-02---funções-que-fazem-a-busca"><span class="toc-section-number">10.1.2</span> Passo 02 - Funções que fazem a busca</a></li>
<li><a href="extr-dados.html#passo-03---usando-a-função" id="toc-passo-03---usando-a-função"><span class="toc-section-number">10.1.3</span> Passo 03 - Usando a função</a></li>
</ul></li>
<li><a href="extr-dados.html#listas-ref" id="toc-listas-ref"><span class="toc-section-number">10.2</span> Listas de referência</a>
<ul>
<li><a href="extr-dados.html#hábito-da-planta" id="toc-hábito-da-planta"><span class="toc-section-number">10.2.1</span> Hábito da planta</a></li>
<li><a href="extr-dados.html#estado-de-fertilidade-da-amostra" id="toc-estado-de-fertilidade-da-amostra"><span class="toc-section-number">10.2.2</span> Estado de fertilidade da amostra</a></li>
<li><a href="extr-dados.html#classes-de-hábitat" id="toc-classes-de-hábitat"><span class="toc-section-number">10.2.3</span> Classes de hábitat</a></li>
<li><a href="extr-dados.html#textura-do-solo" id="toc-textura-do-solo"><span class="toc-section-number">10.2.4</span> Textura do solo</a></li>
<li><a href="extr-dados.html#exsudato" id="toc-exsudato"><span class="toc-section-number">10.2.5</span> Exsudato</a></li>
</ul></li>
<li><a href="extr-dados.html#extraindo-altura-e-dap" id="toc-extraindo-altura-e-dap"><span class="toc-section-number">10.3</span> Extraindo altura e dap</a>
<ul>
<li><a href="extr-dados.html#altura" id="toc-altura"><span class="toc-section-number">10.3.1</span> Altura</a></li>
<li><a href="extr-dados.html#dap" id="toc-dap"><span class="toc-section-number">10.3.2</span> DAP</a></li>
</ul></li>
<li><a href="extr-dados.html#usando-essas-funções" id="toc-usando-essas-funções"><span class="toc-section-number">10.4</span> Usando essas funções</a>
<ul>
<li><a href="extr-dados.html#obtendo-valores-de-altura" id="toc-obtendo-valores-de-altura"><span class="toc-section-number">10.4.1</span> Obtendo valores de altura</a></li>
<li><a href="extr-dados.html#obtendo-valores-de-dap" id="toc-obtendo-valores-de-dap"><span class="toc-section-number">10.4.2</span> Obtendo valores de DAP</a></li>
</ul></li>
</ul></li>
<li><a href="#part-parte-ii" id="toc-part-parte-ii">(PART) Parte II</a></li>
<li><a href="aed-checa-dados.html#aed-checa-dados" id="toc-aed-checa-dados"><span class="toc-section-number">11</span> Checagem dos dados</a>
<ul>
<li><a href="aed-checa-dados.html#tem-valores-ausentes" id="toc-tem-valores-ausentes"><span class="toc-section-number">11.1</span> Tem valores ausentes?</a></li>
<li><a href="aed-checa-dados.html#colunas-com-fatores" id="toc-colunas-com-fatores"><span class="toc-section-number">11.2</span> Colunas com fatores</a></li>
</ul></li>
<li><a href="aed-univar.html#aed-univar" id="toc-aed-univar"><span class="toc-section-number">12</span> AED de univariadas</a>
<ul>
<li><a href="aed-univar.html#qual-a-distribuição-dos-valores-numéricos" id="toc-qual-a-distribuição-dos-valores-numéricos"><span class="toc-section-number">12.1</span> Qual a distribuição dos valores numéricos?</a>
<ul>
<li><a href="aed-univar.html#dados-do-tutorial" id="toc-dados-do-tutorial"><span class="toc-section-number">12.1.1</span> Dados do tutorial</a></li>
</ul></li>
<li><a href="aed-univar.html#tabelas-de-variáveis-categóricas" id="toc-tabelas-de-variáveis-categóricas"><span class="toc-section-number">12.2</span> Tabelas de variáveis categóricas</a>
<ul>
<li><a href="aed-univar.html#resumo-de-gráficos-univariados" id="toc-resumo-de-gráficos-univariados"><span class="toc-section-number">12.2.1</span> Resumo de gráficos univariados</a></li>
</ul></li>
<li><a href="aed-univar.html#as-variáveis-têm-distribuição-normal" id="toc-as-variáveis-têm-distribuição-normal"><span class="toc-section-number">12.3</span> As variáveis têm distribuição normal?</a></li>
<li><a href="aed-univar.html#sabermais-aed-univariadas" id="toc-sabermais-aed-univariadas"><span class="toc-section-number">12.4</span> Para saber mais:</a></li>
</ul></li>
<li><a href="aed-bivar.html#aed-bivar" id="toc-aed-bivar"><span class="toc-section-number">13</span> AED de bivariadas</a>
<ul>
<li><a href="aed-bivar.html#dados-do-tutorial-1" id="toc-dados-do-tutorial-1"><span class="toc-section-number">13.1</span> Dados do tutorial</a></li>
<li><a href="aed-bivar.html#fatores-e-contagens" id="toc-fatores-e-contagens"><span class="toc-section-number">13.2</span> Fatores e contagens</a></li>
<li><a href="aed-bivar.html#variável-numérica-vs.-fator" id="toc-variável-numérica-vs.-fator"><span class="toc-section-number">13.3</span> Variável numérica vs. fator</a></li>
<li><a href="aed-bivar.html#variável-numérica-vs.-numérica" id="toc-variável-numérica-vs.-numérica"><span class="toc-section-number">13.4</span> Variável numérica vs. numérica</a></li>
<li><a href="aed-bivar.html#outros-gráficos-bivariados" id="toc-outros-gráficos-bivariados"><span class="toc-section-number">13.5</span> Outros gráficos bivariados</a></li>
</ul></li>
<li><a href="aed-multivar.html#aed-multivar" id="toc-aed-multivar"><span class="toc-section-number">14</span> AED de multivariadas</a>
<ul>
<li><a href="aed-multivar.html#matrizes-de-distância" id="toc-matrizes-de-distância"><span class="toc-section-number">14.1</span> Matrizes de distância</a></li>
<li><a href="aed-multivar.html#ordenação-com-matrizes-de-distância" id="toc-ordenação-com-matrizes-de-distância"><span class="toc-section-number">14.2</span> Ordenação com matrizes de distância</a></li>
<li><a href="aed-multivar.html#escalonamento-não-métrico-multimensional-nmds" id="toc-escalonamento-não-métrico-multimensional-nmds"><span class="toc-section-number">14.3</span> Escalonamento Não-Métrico Multimensional (NMDS)</a>
<ul>
<li><a href="aed-multivar.html#exemplo-com-dados-morfológicos" id="toc-exemplo-com-dados-morfológicos"><span class="toc-section-number">14.3.1</span> Exemplo com dados morfológicos</a></li>
</ul></li>
<li><a href="aed-multivar.html#análises-de-agrupamento" id="toc-análises-de-agrupamento"><span class="toc-section-number">14.4</span> Análises de agrupamento</a>
<ul>
<li><a href="aed-multivar.html#agrupamento-pelo-método-da-mínima-variância" id="toc-agrupamento-pelo-método-da-mínima-variância"><span class="toc-section-number">14.4.1</span> Agrupamento pelo método da mínima variância</a></li>
<li><a href="aed-multivar.html#agrupamento-por-upgma" id="toc-agrupamento-por-upgma"><span class="toc-section-number">14.4.2</span> Agrupamento por UPGMA</a></li>
<li><a href="aed-multivar.html#agrupamento-por-centróides" id="toc-agrupamento-por-centróides"><span class="toc-section-number">14.4.3</span> Agrupamento por centróides</a></li>
<li><a href="aed-multivar.html#exemplo-florístico" id="toc-exemplo-florístico"><span class="toc-section-number">14.4.4</span> Exemplo florístico</a></li>
<li><a href="aed-multivar.html#análise-de-coordenadas-principais-pcoa" id="toc-análise-de-coordenadas-principais-pcoa"><span class="toc-section-number">14.4.5</span> Análise de Coordenadas Principais (PCoA)</a></li>
</ul></li>
<li><a href="aed-multivar.html#componentes-principais-pca" id="toc-componentes-principais-pca"><span class="toc-section-number">14.5</span> Componentes Principais (PCA)</a></li>
</ul></li>
<li><a href="#appendix-apêndice" id="toc-appendix-apêndice">(APPENDIX) Apêndice</a></li>
<li><a href="base-tidyverse.html#base-tidyverse" id="toc-base-tidyverse"><span class="toc-section-number">15</span> Base R vs. Tidyverse</a>
<ul>
<li><a href="base-tidyverse.html#o-que-é-o-tidyverse" id="toc-o-que-é-o-tidyverse"><span class="toc-section-number">15.1</span> O que é o Tidyverse?</a>
<ul>
<li><a href="base-tidyverse.html#dplyr-e-ggplot2-símbolos-do-tidyverse" id="toc-dplyr-e-ggplot2-símbolos-do-tidyverse"><span class="toc-section-number">15.1.1</span> <code>dplyr</code> e <code>ggplot2</code>, símbolos do Tidyverse</a></li>
</ul></li>
<li><a href="base-tidyverse.html#usando-o-dplyr" id="toc-usando-o-dplyr"><span class="toc-section-number">15.2</span> Usando o <code>dplyr</code></a>
<ul>
<li><a href="base-tidyverse.html#selecionando-colunas-com-select" id="toc-selecionando-colunas-com-select"><span class="toc-section-number">15.2.1</span> Selecionando colunas com <code>select()</code></a></li>
<li><a href="base-tidyverse.html#filtrando-dados-com-filter" id="toc-filtrando-dados-com-filter"><span class="toc-section-number">15.2.2</span> Filtrando dados com <code>filter()</code></a></li>
<li><a href="base-tidyverse.html#destrinchando-as-funções-group_by-e-summarise" id="toc-destrinchando-as-funções-group_by-e-summarise"><span class="toc-section-number">15.2.3</span> Destrinchando as funções <code>group_by</code> e <code>summarise</code></a></li>
</ul></li>
<li><a href="base-tidyverse.html#o-operador-e-o-encadeamento-de-ações" id="toc-o-operador-e-o-encadeamento-de-ações"><span class="toc-section-number">15.3</span> O operador <code>%&gt;%</code> e o encadeamento de ações</a>
<ul>
<li><a href="base-tidyverse.html#com1" id="toc-com1"><span class="toc-section-number">15.3.1</span> Conjunto de comandos 1</a></li>
<li><a href="base-tidyverse.html#com2" id="toc-com2"><span class="toc-section-number">15.3.2</span> Conjunto de comandos 2</a></li>
<li><a href="base-tidyverse.html#pipe" id="toc-pipe"><span class="toc-section-number">15.3.3</span> Resumo do operador <code>%&gt;%</code>:</a></li>
</ul></li>
<li><a href="base-tidyverse.html#usando-o-ggplot2" id="toc-usando-o-ggplot2"><span class="toc-section-number">15.4</span> Usando o <code>ggplot2</code></a></li>
<li><a href="base-tidyverse.html#dplyr-e-ggplot2-em-conjunto" id="toc-dplyr-e-ggplot2-em-conjunto"><span class="toc-section-number">15.5</span> <code>dplyr</code> e <code>ggplot2</code> em conjunto</a>
<ul>
<li><a href="base-tidyverse.html#gráfico-de-espalhamento" id="toc-gráfico-de-espalhamento"><span class="toc-section-number">15.5.1</span> Gráfico de espalhamento</a></li>
<li><a href="base-tidyverse.html#diagrama-de-caixas" id="toc-diagrama-de-caixas"><span class="toc-section-number">15.5.2</span> Diagrama de caixas</a></li>
<li><a href="base-tidyverse.html#histograma" id="toc-histograma"><span class="toc-section-number">15.5.3</span> Histograma</a></li>
</ul></li>
<li><a href="base-tidyverse.html#baser" id="toc-baser"><span class="toc-section-number">15.6</span> Comparando o mesmo conjunto de ações entre <code>base</code> R e <code>dplyr</code></a>
<ul>
<li><a href="base-tidyverse.html#e-o-uso-do-operador-com-o-pacote-base" id="toc-e-o-uso-do-operador-com-o-pacote-base"><span class="toc-section-number">15.6.1</span> E o uso do operador <code>%&gt;%</code> com o pacote <code>base</code>?</a></li>
</ul></li>
<li><a href="base-tidyverse.html#tidyverse-um-resumo" id="toc-tidyverse-um-resumo"><span class="toc-section-number">15.7</span> Tidyverse, um resumo</a></li>
<li><a href="base-tidyverse.html#sabermais-tidyverse" id="toc-sabermais-tidyverse"><span class="toc-section-number">15.8</span> Para saber mais:</a></li>
</ul></li>
<li><a href="unzip.html#unzip" id="toc-unzip"><span class="toc-section-number">16</span> Baixar e descomprimir um arquivo</a></li>
<li><a href="videos.html#videos" id="toc-videos"><span class="toc-section-number">17</span> Aulas em vídeo</a>
<ul>
<li><a href="videos.html#importando-e-exportando-dados" id="toc-importando-e-exportando-dados"><span class="toc-section-number">17.1</span> Importando e exportando dados</a></li>
<li><a href="videos.html#criação-de-vetores-1" id="toc-criação-de-vetores-1"><span class="toc-section-number">17.2</span> Criação de vetores</a></li>
<li><a href="videos.html#classes-de-vetores-e-fatores" id="toc-classes-de-vetores-e-fatores"><span class="toc-section-number">17.3</span> Classes de vetores e fatores</a></li>
<li><a href="videos.html#sequências-numéricas-e-repetições-operações-e-funções-com-vetores" id="toc-sequências-numéricas-e-repetições-operações-e-funções-com-vetores"><span class="toc-section-number">17.4</span> Sequências numéricas e repetições, operações e funções com vetores</a></li>
<li><a href="videos.html#listas-1" id="toc-listas-1"><span class="toc-section-number">17.5</span> Listas</a></li>
<li><a href="videos.html#criando-matrizes-1" id="toc-criando-matrizes-1"><span class="toc-section-number">17.6</span> Criando matrizes</a></li>
<li><a href="videos.html#criando-dataframes-e-operações-importantes-em-matrizes-e-dataframes" id="toc-criando-dataframes-e-operações-importantes-em-matrizes-e-dataframes"><span class="toc-section-number">17.7</span> Criando dataframes, e operações importantes em matrizes e dataframes</a></li>
<li><a href="videos.html#indexação-de-matrizes-e-dataframes" id="toc-indexação-de-matrizes-e-dataframes"><span class="toc-section-number">17.8</span> Indexação de matrizes e dataframes</a></li>
<li><a href="videos.html#condicionais-1" id="toc-condicionais-1"><span class="toc-section-number">17.9</span> Condicionais</a></li>
<li><a href="videos.html#funções-da-família-apply" id="toc-funções-da-família-apply"><span class="toc-section-number">17.10</span> Funções da família <code>apply(")</code></a></li>
<li><a href="videos.html#funções-de-manipulação-de-pasta-e-arquivos" id="toc-funções-de-manipulação-de-pasta-e-arquivos"><span class="toc-section-number">17.11</span> Funções de manipulação de pasta e arquivos</a></li>
<li><a href="videos.html#funções-de-manipulação-de-texto---parte-01" id="toc-funções-de-manipulação-de-texto---parte-01"><span class="toc-section-number">17.12</span> Funções de manipulação de texto - parte 01</a></li>
<li><a href="videos.html#funções-de-manipulação-de-texto---parte-02" id="toc-funções-de-manipulação-de-texto---parte-02"><span class="toc-section-number">17.13</span> Funções de manipulação de texto - parte 02</a></li>
<li><a href="videos.html#objetos-complexos" id="toc-objetos-complexos"><span class="toc-section-number">17.14</span> Objetos complexos</a></li>
</ul></li>
<li><a href="referências.html#referências" id="toc-referências">Referências</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado com pacote R bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Curso básico de introdução à linguagem R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="aed-multivar" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">14</span> AED de multivariadas<a href="aed-multivar.html#aed-multivar" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Neste tutorial, vamos utilizar os pacotes abaixo.
Caso você não possua algum dos pacotes listados, lembre-se de instalar cada um utilizando o comando abaixo:</p>
<div class="sourceCode" id="cb1749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1749-1"><a href="aed-multivar.html#cb1749-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para instalar pacotes no R, use a funcao `install.packages()`</span></span>
<span id="cb1749-2"><a href="aed-multivar.html#cb1749-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;ape&quot;</span>)</span>
<span id="cb1749-3"><a href="aed-multivar.html#cb1749-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;labdsv&quot;</span>)</span></code></pre></div>
<p>Carregue-os todos e siga em frente.</p>
<div class="sourceCode" id="cb1750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1750-1"><a href="aed-multivar.html#cb1750-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;labdsv&quot;</span>)</span>
<span id="cb1750-2"><a href="aed-multivar.html#cb1750-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ape&quot;</span>)</span>
<span id="cb1750-3"><a href="aed-multivar.html#cb1750-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;vegan&quot;</span>)</span></code></pre></div>
<div id="matrizes-de-distância" class="section level2 hasAnchor" number="14.1">
<h2><span class="header-section-number">14.1</span> Matrizes de distância<a href="aed-multivar.html#matrizes-de-distância" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Matrizes de distância ou dissimilaridade são muito usadas em AEDs multivariadas.
Por exemplo, para estimar a similaridade entre diferentes comunidades vegetais segundo a presença ou ausência de espécies (ou um índice de similaridade que leva em conta as abundâncias relativas); para estimar a similaridade entre espécies ou a relação entre similaridade genética ou morfológica e distância geográfica etc.</p>
<p>A função <code>dist()</code> é a mais básica do R para calcular dissimilaridades entre objetos.
Ela calcula dissimilaridades segundo diferentes métodos (argumento <code>method</code>).
Há também a função <code>vegdist()</code> do pacote <code>vegan</code> <span class="citation">(<a href="#ref-R-vegan" role="doc-biblioref">Oksanen et al. 2020</a>)</span> que faz a mesma coisa, mas tem índices de dissimilaridade que <code>dist()</code> não implementa, muito dos quais muito usados em ecologia de comunidades.</p>
<p>Busque ler o <code>?</code> dessas duas funções (execute <code>?dist</code> e <code>?vegdist</code> no console), atentando para os diferentes índices de dissimilaridade.
Na função <code>vegdist()</code>, você encontra os principais <strong>índices de dissimilaridade</strong> usados em ecologia.</p>
<p>Para entender o que essas funções fazem, vamos ver um exemplo simples de cálculo de distância euclidiana, que é o método padrão de <code>dist()</code>.</p>
<div class="sourceCode" id="cb1751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1751-1"><a href="aed-multivar.html#cb1751-1" aria-hidden="true" tabindex="-1"></a><span class="co"># usando o método euclidiano</span></span>
<span id="cb1751-2"><a href="aed-multivar.html#cb1751-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plota um gráfico vazio com coordenadas x e y de 1 a 10</span></span>
<span id="cb1751-3"><a href="aed-multivar.html#cb1751-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb1751-4"><a href="aed-multivar.html#cb1751-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1751-5"><a href="aed-multivar.html#cb1751-5" aria-hidden="true" tabindex="-1"></a><span class="co"># adiciona dois pontos:</span></span>
<span id="cb1751-6"><a href="aed-multivar.html#cb1751-6" aria-hidden="true" tabindex="-1"></a><span class="co"># um na coordenada 4,4</span></span>
<span id="cb1751-7"><a href="aed-multivar.html#cb1751-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb1751-8"><a href="aed-multivar.html#cb1751-8" aria-hidden="true" tabindex="-1"></a><span class="co"># outro na coordenada x=8, y=8</span></span>
<span id="cb1751-9"><a href="aed-multivar.html#cb1751-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">8</span>, <span class="dv">8</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb1751-10"><a href="aed-multivar.html#cb1751-10" aria-hidden="true" tabindex="-1"></a><span class="co"># a distancia euclidiana entre eles é dada por essa linha</span></span>
<span id="cb1751-11"><a href="aed-multivar.html#cb1751-11" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">8</span>)</span>
<span id="cb1751-12"><a href="aed-multivar.html#cb1751-12" aria-hidden="true" tabindex="-1"></a><span class="co"># essa linha é a hipotenusa do triângulo</span></span>
<span id="cb1751-13"><a href="aed-multivar.html#cb1751-13" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">8</span>, <span class="dv">4</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">4</span>, <span class="dv">4</span>), <span class="at">density =</span> <span class="dv">40</span>)</span></code></pre></div>
<p><img src="bot89-introR_files/figure-html/unnamed-chunk-486-1.png" width="672" /></p>
<div class="sourceCode" id="cb1752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1752-1"><a href="aed-multivar.html#cb1752-1" aria-hidden="true" tabindex="-1"></a><span class="co"># portanto a distancia entre os pontos, por Pitágoras, é</span></span>
<span id="cb1752-2"><a href="aed-multivar.html#cb1752-2" aria-hidden="true" tabindex="-1"></a><span class="co"># sqrt(hipotenusa) = sum(catetoA^2+catetoB^2)</span></span>
<span id="cb1752-3"><a href="aed-multivar.html#cb1752-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((<span class="dv">8</span> <span class="sc">-</span> <span class="dv">4</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (<span class="dv">8</span> <span class="sc">-</span> <span class="dv">4</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb1752-4"><a href="aed-multivar.html#cb1752-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1752-5"><a href="aed-multivar.html#cb1752-5" aria-hidden="true" tabindex="-1"></a><span class="co"># agora usando a função dist</span></span>
<span id="cb1752-6"><a href="aed-multivar.html#cb1752-6" aria-hidden="true" tabindex="-1"></a><span class="co"># coloco as coordenadas dos dois pontos acima num data.frame</span></span>
<span id="cb1752-7"><a href="aed-multivar.html#cb1752-7" aria-hidden="true" tabindex="-1"></a>pontos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">8</span>), <span class="at">Y =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">8</span>))</span>
<span id="cb1752-8"><a href="aed-multivar.html#cb1752-8" aria-hidden="true" tabindex="-1"></a>pontos</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
X
</th>
<th style="text-align:right;">
Y
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
8
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1753-1"><a href="aed-multivar.html#cb1753-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calcula a distancia euclidiana para essas variáveis (X e Y)</span></span>
<span id="cb1753-2"><a href="aed-multivar.html#cb1753-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dist</span>(pontos, <span class="at">method =</span> <span class="st">&quot;eucl&quot;</span>)</span></code></pre></div>
<pre><code>##          1
## 2 5.656854</code></pre>
<div class="sourceCode" id="cb1755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1755-1"><a href="aed-multivar.html#cb1755-1" aria-hidden="true" tabindex="-1"></a><span class="co"># entao isso é verdadeiro</span></span>
<span id="cb1755-2"><a href="aed-multivar.html#cb1755-2" aria-hidden="true" tabindex="-1"></a>d <span class="sc">==</span> <span class="fu">dist</span>(pontos, <span class="at">method =</span> <span class="st">&quot;eucl&quot;</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="ordenação-com-matrizes-de-distância" class="section level2 hasAnchor" number="14.2">
<h2><span class="header-section-number">14.2</span> Ordenação com matrizes de distância<a href="aed-multivar.html#ordenação-com-matrizes-de-distância" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Reduzir espaços multivariados em poucas dimensões a partir de matrizes de distância é útil quando nossas variáveis não têm distribuição normal, que é uma das premissas da <em>Análise de Componentes Principais</em> (PCA) e outros métodos de ordenação paramétricos.</p>
<p>Se você parte de uma matriz de distância, pode fazer ordenações multivariadas com dados não normais ou mesmo dados categóricos e semi-quantitativos, desde que com eles você possa calcular uma matriz de distância.</p>
</div>
<div id="escalonamento-não-métrico-multimensional-nmds" class="section level2 hasAnchor" number="14.3">
<h2><span class="header-section-number">14.3</span> Escalonamento Não-Métrico Multimensional (NMDS)<a href="aed-multivar.html#escalonamento-não-métrico-multimensional-nmds" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A <a href="https://en.wikipedia.org/wiki/Multidimensional_scaling">NMDS</a> é uma técnica de ordenação multivariada que permite visualizar graficamente distâncias entre objetos.
No R há várias funções que executam isso: <code>isoMDS()</code>; <code>cmdscale()</code>; e <code>nmds()</code> e <code>bestnmds()</code> do pacote <code>labdsv</code> <span class="citation">(<a href="#ref-R-labdsv" role="doc-biblioref">Roberts 2019</a>)</span>.
Vamos usar a função <code>bestnmds()</code> nos exemplos abaixo.
Para entender, veja um exemplo para distâncias geográficas entre cidades na região norte do Brasil. Se queremos representar graficamente distâncias geográficas, estaremos de certa forma reproduzindo um mapa:</p>
<p>Vamos utilizar o conjunto de <a href="https://github.com/LABOTAM/IntroR/blob/main/dados/municipiosbrasil.csv">dados contendo coordenadas geográficas de municípios do Brasil</a> para esta prática, utilizado na seção <a href="mat-dframe.html#import-dados">3.4.2</a>.</p>
<div class="sourceCode" id="cb1757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1757-1"><a href="aed-multivar.html#cb1757-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualizando distancias usando NMDS</span></span>
<span id="cb1757-2"><a href="aed-multivar.html#cb1757-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Vamos usar o arquivo com coordenadas dos municipios brasileiros</span></span>
<span id="cb1757-3"><a href="aed-multivar.html#cb1757-3" aria-hidden="true" tabindex="-1"></a>muni <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file =</span> <span class="st">&quot;municipiosbrasil.csv&quot;</span>, <span class="at">header =</span> T, <span class="at">as.is =</span> T, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">&quot;NA&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;NULL&quot;</span>))</span></code></pre></div>
<p>Para simplificar, vamos filtrar apenas algumas cidades da região Norte:</p>
<div class="sourceCode" id="cb1758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1758-1"><a href="aed-multivar.html#cb1758-1" aria-hidden="true" tabindex="-1"></a>cids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Rio Branco&quot;</span>, <span class="st">&quot;Cruzeiro do Sul&quot;</span>, <span class="st">&quot;Tabatinga&quot;</span>, <span class="st">&quot;São Gabriel da Cachoeira&quot;</span>, <span class="st">&quot;Manaus&quot;</span>, <span class="st">&quot;Santarém&quot;</span>, <span class="st">&quot;Porto Velho&quot;</span>, <span class="st">&quot;Humaitá&quot;</span>, <span class="st">&quot;Belém&quot;</span>, <span class="st">&quot;Macapá&quot;</span>, <span class="st">&quot;Marabá&quot;</span>, <span class="st">&quot;Boa Vista&quot;</span>)</span>
<span id="cb1758-2"><a href="aed-multivar.html#cb1758-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1758-3"><a href="aed-multivar.html#cb1758-3" aria-hidden="true" tabindex="-1"></a><span class="co"># filtrando os dados</span></span>
<span id="cb1758-4"><a href="aed-multivar.html#cb1758-4" aria-hidden="true" tabindex="-1"></a>vl <span class="ot">&lt;-</span> muni<span class="sc">$</span>Municipio <span class="sc">%in%</span> cids</span>
<span id="cb1758-5"><a href="aed-multivar.html#cb1758-5" aria-hidden="true" tabindex="-1"></a>muni <span class="ot">&lt;-</span> muni[vl, ]</span>
<span id="cb1758-6"><a href="aed-multivar.html#cb1758-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1758-7"><a href="aed-multivar.html#cb1758-7" aria-hidden="true" tabindex="-1"></a><span class="co"># calcula a distancia geografica entre essas cidades (em graus de latitude).</span></span>
<span id="cb1758-8"><a href="aed-multivar.html#cb1758-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Idealmente deveríamos converter latitude e longitude em décimos de graus para UTM para obter distancias em km ou m.</span></span>
<span id="cb1758-9"><a href="aed-multivar.html#cb1758-9" aria-hidden="true" tabindex="-1"></a>mdist <span class="ot">&lt;-</span> <span class="fu">dist</span>(muni[, <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>, <span class="st">&quot;Latitude&quot;</span>)], <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1759-1"><a href="aed-multivar.html#cb1759-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculando um nmds em dois eixos (reduzindo a variação na matriz em dois eixos)</span></span>
<span id="cb1759-2"><a href="aed-multivar.html#cb1759-2" aria-hidden="true" tabindex="-1"></a>?bestnmds</span></code></pre></div>
<p>Vamos utilizar a função <code>bestnmds</code> do pacote <code>labdsv</code>
Vamos agora instalar o pacote e carregar o pacote <code>labdsv</code>:</p>
<div class="sourceCode" id="cb1760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1760-1"><a href="aed-multivar.html#cb1760-1" aria-hidden="true" tabindex="-1"></a>onmds <span class="ot">&lt;-</span> <span class="fu">bestnmds</span>(mdist, <span class="at">k =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>##  [1] 3.739034e-13 8.167216e-03 2.228642e+01 3.791436e+01 6.603351e-03
##  [6] 6.029306e-03 2.109747e+01 9.041554e-03 4.415954e-03 4.861851e-01
## [11] 4.001459e-03 8.141675e-03 9.111469e-03 3.737914e+01 6.265940e-03
## [16] 4.124426e+01 9.818992e+00 2.702450e+01 3.316186e-03 3.712228e+01
## 
## best result = 1
## with stress = 3.739034e-13</code></pre>
<div class="sourceCode" id="cb1762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1762-1"><a href="aed-multivar.html#cb1762-1" aria-hidden="true" tabindex="-1"></a><span class="co"># veja a estrutura do resultado</span></span>
<span id="cb1762-2"><a href="aed-multivar.html#cb1762-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(onmds)</span></code></pre></div>
<pre><code>## List of 3
##  $ points: num [1:21, 1:2] -18.2 -12.9 17.3 -14.7 -16.4 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:21] &quot;3&quot; &quot;14&quot; &quot;74&quot; &quot;135&quot; ...
##   .. ..$ : NULL
##  $ stress: num 3.74e-13
##  $ type  : chr &quot;NMDS&quot;
##  - attr(*, &quot;class&quot;)= chr [1:2] &quot;dsvord&quot; &quot;nmds&quot;
##  - attr(*, &quot;call&quot;)= language bestnmds(dis = mdist, k = 2)
##  - attr(*, &quot;timestamp&quot;)= chr &quot;Tue Nov  8 17:59:40 2022&quot;</code></pre>
<div class="sourceCode" id="cb1764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1764-1"><a href="aed-multivar.html#cb1764-1" aria-hidden="true" tabindex="-1"></a><span class="co"># o valor do stress indica o ajuste. Se o stress for 0, o ajuste é perfeito:</span></span>
<span id="cb1764-2"><a href="aed-multivar.html#cb1764-2" aria-hidden="true" tabindex="-1"></a><span class="co"># a posição dos pontos é proporcional a distância entre eles</span></span>
<span id="cb1764-3"><a href="aed-multivar.html#cb1764-3" aria-hidden="true" tabindex="-1"></a>onmds<span class="sc">$</span>stress</span></code></pre></div>
<pre><code>## [1] 3.739034e-13</code></pre>
<div class="sourceCode" id="cb1766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1766-1"><a href="aed-multivar.html#cb1766-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quanto da variação foi explicada?</span></span>
<span id="cb1766-2"><a href="aed-multivar.html#cb1766-2" aria-hidden="true" tabindex="-1"></a><span class="co"># essa pergunta a gente faz com PCA, não faz sentido fazer com NMDS.</span></span>
<span id="cb1766-3"><a href="aed-multivar.html#cb1766-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Mas, se você quer ter uma ideia de quanto um eixo capturou da variação,</span></span>
<span id="cb1766-4"><a href="aed-multivar.html#cb1766-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pode correlacionar a matriz de distancia original com uma matriz de distancia</span></span>
<span id="cb1766-5"><a href="aed-multivar.html#cb1766-5" aria-hidden="true" tabindex="-1"></a><span class="co"># gerada pelos valores dos eixos nmds</span></span>
<span id="cb1766-6"><a href="aed-multivar.html#cb1766-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1766-7"><a href="aed-multivar.html#cb1766-7" aria-hidden="true" tabindex="-1"></a><span class="co"># pega os valores dos eixos NMDS</span></span>
<span id="cb1766-8"><a href="aed-multivar.html#cb1766-8" aria-hidden="true" tabindex="-1"></a>ptsnmds <span class="ot">&lt;-</span> onmds<span class="sc">$</span>points</span>
<span id="cb1766-9"><a href="aed-multivar.html#cb1766-9" aria-hidden="true" tabindex="-1"></a><span class="co"># calcula a distancia</span></span>
<span id="cb1766-10"><a href="aed-multivar.html#cb1766-10" aria-hidden="true" tabindex="-1"></a>adist <span class="ot">&lt;-</span> <span class="fu">dist</span>(ptsnmds)</span>
<span id="cb1766-11"><a href="aed-multivar.html#cb1766-11" aria-hidden="true" tabindex="-1"></a><span class="co"># qual a correlacao entre essas matrizes de distancia?</span></span>
<span id="cb1766-12"><a href="aed-multivar.html#cb1766-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(mdist, adist)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb1768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1768-1"><a href="aed-multivar.html#cb1768-1" aria-hidden="true" tabindex="-1"></a><span class="co"># por isso o stress é baixo</span></span>
<span id="cb1768-2"><a href="aed-multivar.html#cb1768-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1768-3"><a href="aed-multivar.html#cb1768-3" aria-hidden="true" tabindex="-1"></a><span class="co"># vamos comparar graficamente:</span></span>
<span id="cb1768-4"><a href="aed-multivar.html#cb1768-4" aria-hidden="true" tabindex="-1"></a><span class="co"># divide o dispositivo em duas partes</span></span>
<span id="cb1768-5"><a href="aed-multivar.html#cb1768-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb1768-6"><a href="aed-multivar.html#cb1768-6" aria-hidden="true" tabindex="-1"></a><span class="co"># adiciona limite no eixo X e y</span></span>
<span id="cb1768-7"><a href="aed-multivar.html#cb1768-7" aria-hidden="true" tabindex="-1"></a>xl <span class="ot">&lt;-</span> <span class="fu">range</span>(ptsnmds[, <span class="dv">1</span>]) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb1768-8"><a href="aed-multivar.html#cb1768-8" aria-hidden="true" tabindex="-1"></a>yl <span class="ot">&lt;-</span> <span class="fu">range</span>(ptsnmds[, <span class="dv">2</span>]) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb1768-9"><a href="aed-multivar.html#cb1768-9" aria-hidden="true" tabindex="-1"></a><span class="co"># plota pontos</span></span>
<span id="cb1768-10"><a href="aed-multivar.html#cb1768-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ptsnmds, <span class="at">type =</span> <span class="st">&quot;p&quot;</span>, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> <span class="st">&quot;red&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;NMDS 1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;NMDS 2&quot;</span>, <span class="at">xlim =</span> xl, <span class="at">ylim =</span> yl, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb1768-11"><a href="aed-multivar.html#cb1768-11" aria-hidden="true" tabindex="-1"></a><span class="co"># adiciona o nome das cidades</span></span>
<span id="cb1768-12"><a href="aed-multivar.html#cb1768-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(ptsnmds, <span class="at">labels =</span> muni<span class="sc">$</span>Municipio, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">pos =</span> <span class="dv">4</span>)</span>
<span id="cb1768-13"><a href="aed-multivar.html#cb1768-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1768-14"><a href="aed-multivar.html#cb1768-14" aria-hidden="true" tabindex="-1"></a>xl <span class="ot">&lt;-</span> <span class="fu">range</span>(muni<span class="sc">$</span>Longitude) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">5</span>)</span>
<span id="cb1768-15"><a href="aed-multivar.html#cb1768-15" aria-hidden="true" tabindex="-1"></a>yl <span class="ot">&lt;-</span> <span class="fu">range</span>(muni<span class="sc">$</span>Latitude) <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb1768-16"><a href="aed-multivar.html#cb1768-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(muni<span class="sc">$</span>Longitude, muni<span class="sc">$</span>Latitude, <span class="at">type =</span> <span class="st">&quot;p&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Latitude&quot;</span>, <span class="at">xlim =</span> xl, <span class="at">ylim =</span> yl, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb1768-17"><a href="aed-multivar.html#cb1768-17" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(muni<span class="sc">$</span>Longitude, muni<span class="sc">$</span>Latitude, <span class="at">labels =</span> muni<span class="sc">$</span>Municipio, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">pos =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="bot89-introR_files/figure-html/unnamed-chunk-491-1.png" width="672" /></p>
<div id="exemplo-com-dados-morfológicos" class="section level3 hasAnchor" number="14.3.1">
<h3><span class="header-section-number">14.3.1</span> Exemplo com dados morfológicos<a href="aed-multivar.html#exemplo-com-dados-morfológicos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Um exemplo de NMDS para mostra a similaridade entre indivíduos de <em>Iris</em> a partir de uma matriz de distância morfológica usando os dados de <code>iris</code> do R.</p>
<div class="sourceCode" id="cb1769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1769-1"><a href="aed-multivar.html#cb1769-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris) <span class="co"># #carrega o conjunto de dados de iris para a area de trabalho</span></span>
<span id="cb1769-2"><a href="aed-multivar.html#cb1769-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
Sepal.Length
</th>
<th style="text-align:right;">
Sepal.Width
</th>
<th style="text-align:right;">
Petal.Length
</th>
<th style="text-align:right;">
Petal.Width
</th>
<th style="text-align:left;">
Species
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
5.1
</td>
<td style="text-align:right;">
3.5
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.9
</td>
<td style="text-align:right;">
3.0
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.7
</td>
<td style="text-align:right;">
3.2
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
4.6
</td>
<td style="text-align:right;">
3.1
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
5.0
</td>
<td style="text-align:right;">
3.6
</td>
<td style="text-align:right;">
1.4
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
<tr>
<td style="text-align:right;">
5.4
</td>
<td style="text-align:right;">
3.9
</td>
<td style="text-align:right;">
1.7
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:left;">
setosa
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1770-1"><a href="aed-multivar.html#cb1770-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calcula a distancia morfológica</span></span>
<span id="cb1770-2"><a href="aed-multivar.html#cb1770-2" aria-hidden="true" tabindex="-1"></a>?dist</span></code></pre></div>
<div class="sourceCode" id="cb1771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1771-1"><a href="aed-multivar.html#cb1771-1" aria-hidden="true" tabindex="-1"></a>dmorfo <span class="ot">&lt;-</span> <span class="fu">dist</span>(iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">method =</span> <span class="st">&quot;eucl&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1772-1"><a href="aed-multivar.html#cb1772-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculando um nmds em dois eixos</span></span>
<span id="cb1772-2"><a href="aed-multivar.html#cb1772-2" aria-hidden="true" tabindex="-1"></a>onmds <span class="ot">&lt;-</span> <span class="fu">bestnmds</span>(dmorfo, <span class="at">k =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1773-1"><a href="aed-multivar.html#cb1773-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ops objetos 102 e 143 devem ser identificos</span></span>
<span id="cb1773-2"><a href="aed-multivar.html#cb1773-2" aria-hidden="true" tabindex="-1"></a>iris[<span class="fu">c</span>(<span class="dv">102</span>, <span class="dv">143</span>), ]</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Sepal.Length
</th>
<th style="text-align:right;">
Sepal.Width
</th>
<th style="text-align:right;">
Petal.Length
</th>
<th style="text-align:right;">
Petal.Width
</th>
<th style="text-align:left;">
Species
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
102
</td>
<td style="text-align:right;">
5.8
</td>
<td style="text-align:right;">
2.7
</td>
<td style="text-align:right;">
5.1
</td>
<td style="text-align:right;">
1.9
</td>
<td style="text-align:left;">
virginica
</td>
</tr>
<tr>
<td style="text-align:left;">
143
</td>
<td style="text-align:right;">
5.8
</td>
<td style="text-align:right;">
2.7
</td>
<td style="text-align:right;">
5.1
</td>
<td style="text-align:right;">
1.9
</td>
<td style="text-align:left;">
virginica
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1774-1"><a href="aed-multivar.html#cb1774-1" aria-hidden="true" tabindex="-1"></a><span class="co"># entao eliminamos 1, porque senao nao funciona</span></span>
<span id="cb1774-2"><a href="aed-multivar.html#cb1774-2" aria-hidden="true" tabindex="-1"></a>iris2 <span class="ot">&lt;-</span> iris[<span class="sc">-</span><span class="dv">102</span>, ]</span></code></pre></div>
<div class="sourceCode" id="cb1775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1775-1"><a href="aed-multivar.html#cb1775-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculamos novamente a distancia</span></span>
<span id="cb1775-2"><a href="aed-multivar.html#cb1775-2" aria-hidden="true" tabindex="-1"></a>dmorfo <span class="ot">&lt;-</span> <span class="fu">dist</span>(iris2[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">method =</span> <span class="st">&quot;eucl&quot;</span>)</span>
<span id="cb1775-3"><a href="aed-multivar.html#cb1775-3" aria-hidden="true" tabindex="-1"></a><span class="co"># calculando um nmds em dois eixos</span></span>
<span id="cb1775-4"><a href="aed-multivar.html#cb1775-4" aria-hidden="true" tabindex="-1"></a>onmds <span class="ot">&lt;-</span> <span class="fu">bestnmds</span>(dmorfo, <span class="at">k =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1776-1"><a href="aed-multivar.html#cb1776-1" aria-hidden="true" tabindex="-1"></a><span class="co"># veja a estrutura do resultado</span></span>
<span id="cb1776-2"><a href="aed-multivar.html#cb1776-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(onmds)</span></code></pre></div>
<pre><code>## List of 3
##  $ points: num [1:149, 1:2] -2.67 -2.71 -2.87 -2.74 -2.72 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:149] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. ..$ : NULL
##  $ stress: num 2.58
##  $ type  : chr &quot;NMDS&quot;
##  - attr(*, &quot;class&quot;)= chr [1:2] &quot;dsvord&quot; &quot;nmds&quot;
##  - attr(*, &quot;call&quot;)= language bestnmds(dis = dmorfo, k = 2)
##  - attr(*, &quot;timestamp&quot;)= chr &quot;Fri Feb  5 10:50:06 2021&quot;</code></pre>
<div class="sourceCode" id="cb1778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1778-1"><a href="aed-multivar.html#cb1778-1" aria-hidden="true" tabindex="-1"></a><span class="co"># o valor do stress indica o ajuste. Se stress for 0, o ajuste é perfeito</span></span>
<span id="cb1778-2"><a href="aed-multivar.html#cb1778-2" aria-hidden="true" tabindex="-1"></a>onmds<span class="sc">$</span>stress</span></code></pre></div>
<pre><code>## [1] 2.579978</code></pre>
<div class="sourceCode" id="cb1780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1780-1"><a href="aed-multivar.html#cb1780-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quanto da variação foi explicada?</span></span>
<span id="cb1780-2"><a href="aed-multivar.html#cb1780-2" aria-hidden="true" tabindex="-1"></a><span class="co"># essa pergunta a gente faz com PCA, não faz sentido fazer com NMDS.</span></span>
<span id="cb1780-3"><a href="aed-multivar.html#cb1780-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Mas, se você quer ter uma ideia de quanto um eixo capturou da variação,</span></span>
<span id="cb1780-4"><a href="aed-multivar.html#cb1780-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pode correlacionar a matriz de distancia original</span></span>
<span id="cb1780-5"><a href="aed-multivar.html#cb1780-5" aria-hidden="true" tabindex="-1"></a><span class="co"># com uma matriz de distancia gerada pelos valores dos eixos nmds</span></span>
<span id="cb1780-6"><a href="aed-multivar.html#cb1780-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1780-7"><a href="aed-multivar.html#cb1780-7" aria-hidden="true" tabindex="-1"></a><span class="co"># pega os valores dos eixos NMDS</span></span>
<span id="cb1780-8"><a href="aed-multivar.html#cb1780-8" aria-hidden="true" tabindex="-1"></a>ptsnmds <span class="ot">&lt;-</span> onmds<span class="sc">$</span>points</span>
<span id="cb1780-9"><a href="aed-multivar.html#cb1780-9" aria-hidden="true" tabindex="-1"></a><span class="co"># cada linha nessa tabela corresponde</span></span>
<span id="cb1780-10"><a href="aed-multivar.html#cb1780-10" aria-hidden="true" tabindex="-1"></a><span class="co"># à mesma linha na tabela iris2</span></span>
<span id="cb1780-11"><a href="aed-multivar.html#cb1780-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ptsnmds)</span></code></pre></div>
<table>
<tbody>
<tr>
<td style="text-align:right;">
-2.673344
</td>
<td style="text-align:right;">
0.2751282
</td>
</tr>
<tr>
<td style="text-align:right;">
-2.705573
</td>
<td style="text-align:right;">
-0.1645018
</td>
</tr>
<tr>
<td style="text-align:right;">
-2.866471
</td>
<td style="text-align:right;">
-0.0970515
</td>
</tr>
<tr>
<td style="text-align:right;">
-2.737119
</td>
<td style="text-align:right;">
-0.2591412
</td>
</tr>
<tr>
<td style="text-align:right;">
-2.717433
</td>
<td style="text-align:right;">
0.2980718
</td>
</tr>
<tr>
<td style="text-align:right;">
-2.296804
</td>
<td style="text-align:right;">
0.6687755
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1781-1"><a href="aed-multivar.html#cb1781-1" aria-hidden="true" tabindex="-1"></a><span class="co"># essas colunas são os dois eixos NMDS</span></span>
<span id="cb1781-2"><a href="aed-multivar.html#cb1781-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1781-3"><a href="aed-multivar.html#cb1781-3" aria-hidden="true" tabindex="-1"></a><span class="co"># isso deve ser verdadeiro</span></span>
<span id="cb1781-4"><a href="aed-multivar.html#cb1781-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(ptsnmds) <span class="sc">==</span> <span class="fu">nrow</span>(iris2)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb1783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1783-1"><a href="aed-multivar.html#cb1783-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calcula a distancia entre os pontos pelos eixos NMDS</span></span>
<span id="cb1783-2"><a href="aed-multivar.html#cb1783-2" aria-hidden="true" tabindex="-1"></a>adist <span class="ot">&lt;-</span> <span class="fu">dist</span>(ptsnmds)</span>
<span id="cb1783-3"><a href="aed-multivar.html#cb1783-3" aria-hidden="true" tabindex="-1"></a><span class="co"># qual a correlacao entre essa matriz e a original?</span></span>
<span id="cb1783-4"><a href="aed-multivar.html#cb1783-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(dmorfo, adist)</span></code></pre></div>
<pre><code>## [1] 0.9988093</code></pre>
<div class="sourceCode" id="cb1785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1785-1"><a href="aed-multivar.html#cb1785-1" aria-hidden="true" tabindex="-1"></a><span class="co"># por isso o stress é baixo, a correlação é alta</span></span></code></pre></div>
<p>Agora vamos fazer com outro índice de distância chamado <em>gower</em>, por exemplo, que é um bom índice quando se tem dados semiquantitativos na matriz (não é o caso aqui).
Vamos utilizar a função <code>vegdist()</code> do pacote <code>vegan</code> <span class="citation">(<a href="#ref-R-vegan" role="doc-biblioref">Oksanen et al. 2020</a>)</span>.</p>
<div class="sourceCode" id="cb1786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1786-1"><a href="aed-multivar.html#cb1786-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb1786-2"><a href="aed-multivar.html#cb1786-2" aria-hidden="true" tabindex="-1"></a>iris2 <span class="ot">&lt;-</span> iris[<span class="sc">-</span><span class="dv">102</span>, ]</span></code></pre></div>
<div class="sourceCode" id="cb1787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1787-1"><a href="aed-multivar.html#cb1787-1" aria-hidden="true" tabindex="-1"></a>dmorfo2 <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(iris2[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="at">method =</span> <span class="st">&quot;gower&quot;</span>)</span>
<span id="cb1787-2"><a href="aed-multivar.html#cb1787-2" aria-hidden="true" tabindex="-1"></a>onmds2 <span class="ot">&lt;-</span> <span class="fu">bestnmds</span>(dmorfo2, <span class="at">k =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1788-1"><a href="aed-multivar.html#cb1788-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pega os valores dos eixos NMDS</span></span>
<span id="cb1788-2"><a href="aed-multivar.html#cb1788-2" aria-hidden="true" tabindex="-1"></a>ptsnmds2 <span class="ot">&lt;-</span> onmds2<span class="sc">$</span>points</span>
<span id="cb1788-3"><a href="aed-multivar.html#cb1788-3" aria-hidden="true" tabindex="-1"></a><span class="co"># cada linha nessa tabela corresponde</span></span>
<span id="cb1788-4"><a href="aed-multivar.html#cb1788-4" aria-hidden="true" tabindex="-1"></a><span class="co"># à mesma linha na tabela iris2</span></span>
<span id="cb1788-5"><a href="aed-multivar.html#cb1788-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ptsnmds2)</span></code></pre></div>
<table>
<tbody>
<tr>
<td style="text-align:right;">
-0.2907098
</td>
<td style="text-align:right;">
0.0456498
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.2712303
</td>
<td style="text-align:right;">
-0.0244397
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.3013570
</td>
<td style="text-align:right;">
-0.0090738
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.2933819
</td>
<td style="text-align:right;">
-0.0245441
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.3066071
</td>
<td style="text-align:right;">
0.0494793
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.2595641
</td>
<td style="text-align:right;">
0.1165398
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1789-1"><a href="aed-multivar.html#cb1789-1" aria-hidden="true" tabindex="-1"></a><span class="co"># essas colunas são os dois eixos NMDS</span></span>
<span id="cb1789-2"><a href="aed-multivar.html#cb1789-2" aria-hidden="true" tabindex="-1"></a><span class="co"># isso deve ser verdadeiro</span></span>
<span id="cb1789-3"><a href="aed-multivar.html#cb1789-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(ptsnmds2) <span class="sc">==</span> <span class="fu">nrow</span>(iris2)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb1791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1791-1"><a href="aed-multivar.html#cb1791-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calcula a distancia entre os pontos pelos eixos NMDS</span></span>
<span id="cb1791-2"><a href="aed-multivar.html#cb1791-2" aria-hidden="true" tabindex="-1"></a>adist2 <span class="ot">&lt;-</span> <span class="fu">dist</span>(ptsnmds2)</span>
<span id="cb1791-3"><a href="aed-multivar.html#cb1791-3" aria-hidden="true" tabindex="-1"></a><span class="co"># qual a correlacao entre essa matriz e a original?</span></span>
<span id="cb1791-4"><a href="aed-multivar.html#cb1791-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(dmorfo2, adist2)</span></code></pre></div>
<pre><code>## [1] 0.9950709</code></pre>
<div class="sourceCode" id="cb1793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1793-1"><a href="aed-multivar.html#cb1793-1" aria-hidden="true" tabindex="-1"></a><span class="co"># por isso o stress é baixo, a correlação é alta</span></span></code></pre></div>
<div class="sourceCode" id="cb1794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1794-1"><a href="aed-multivar.html#cb1794-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vamos visualizar os dois resultados, onmds e onmds2, graficamente</span></span>
<span id="cb1794-2"><a href="aed-multivar.html#cb1794-2" aria-hidden="true" tabindex="-1"></a><span class="co"># divide o dispositivo em dois</span></span>
<span id="cb1794-3"><a href="aed-multivar.html#cb1794-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb1794-4"><a href="aed-multivar.html#cb1794-4" aria-hidden="true" tabindex="-1"></a>cores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>)[<span class="fu">as.numeric</span>(iris2<span class="sc">$</span>Species)]</span>
<span id="cb1794-5"><a href="aed-multivar.html#cb1794-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ptsnmds, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> cores, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">xlab =</span> <span class="st">&quot;NMDS 1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;NMDS 2&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Objeto: ptsnmds&quot;</span>)</span>
<span id="cb1794-6"><a href="aed-multivar.html#cb1794-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ptsnmds2, <span class="at">pch =</span> <span class="dv">21</span>, <span class="at">bg =</span> cores, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">xlab =</span> <span class="st">&quot;NMDS 1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;NMDS 2&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Objeto: ptsnmds2&quot;</span>)</span></code></pre></div>
<p><img src="bot89-introR_files/figure-html/unnamed-chunk-505-1.png" width="672" /></p>
</div>
</div>
<div id="análises-de-agrupamento" class="section level2 hasAnchor" number="14.4">
<h2><span class="header-section-number">14.4</span> Análises de agrupamento<a href="aed-multivar.html#análises-de-agrupamento" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A função <code>hclust()</code> faz uma análise de agrupamento a partir de uma matriz de distância e segundo um método.
Gera um objeto de classe <code>hclust</code> que contem a estrutura hierárquica da similaridade entre os seus dados (a hierarquia dada pela distância mais o método de agrupamento).</p>
<p>Em análises de agrupamento, é normal lidar com objetos de classe <code>dendrogram</code>.
Podemos converter alguns objetos para esta classe usando a função <code>as.dendrogram()</code>, que facilita a geração de gráficos.</p>
<p>Outra classe importante é <code>phylo</code>, utilizada em objetos que contenham árvores filogenéticas (pacote <code>ape</code> de <span class="citation">Paradis et al. (<a href="#ref-R-ape" role="doc-biblioref">2020</a>)</span>).
Há a função <code>as.phylo()</code> que pode converter um objeto <code>hclust</code> para classe <code>phylo</code> e manipular o dendrograma como se fosse uma filogenia.
Também facilita a geração de gráficos.</p>
<div class="sourceCode" id="cb1795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1795-1"><a href="aed-multivar.html#cb1795-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vamos usar o arquivo com coordenadas dos municipios brasileiros</span></span>
<span id="cb1795-2"><a href="aed-multivar.html#cb1795-2" aria-hidden="true" tabindex="-1"></a>muni <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file =</span> <span class="st">&quot;municipiosbrasil.csv&quot;</span>, <span class="at">header =</span> T, <span class="at">as.is =</span> T, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">&quot;NA&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;NULL&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb1796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1796-1"><a href="aed-multivar.html#cb1796-1" aria-hidden="true" tabindex="-1"></a>cids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Rio Branco&quot;</span>, <span class="st">&quot;Cruzeiro do Sul&quot;</span>, <span class="st">&quot;Tabatinga&quot;</span>, <span class="st">&quot;São Gabriel da Cachoeira&quot;</span>, <span class="st">&quot;Manaus&quot;</span>, <span class="st">&quot;Santarém&quot;</span>, <span class="st">&quot;Porto Velho&quot;</span>, <span class="st">&quot;Humaitá&quot;</span>, <span class="st">&quot;Belém&quot;</span>, <span class="st">&quot;Macapá&quot;</span>, <span class="st">&quot;Marabá&quot;</span>, <span class="st">&quot;Boa Vista&quot;</span>)</span>
<span id="cb1796-2"><a href="aed-multivar.html#cb1796-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1796-3"><a href="aed-multivar.html#cb1796-3" aria-hidden="true" tabindex="-1"></a><span class="co"># filtrando os dados</span></span>
<span id="cb1796-4"><a href="aed-multivar.html#cb1796-4" aria-hidden="true" tabindex="-1"></a>vl <span class="ot">&lt;-</span> muni<span class="sc">$</span>Municipio <span class="sc">%in%</span> cids <span class="sc">&amp;</span> muni<span class="sc">$</span>Regiao <span class="sc">==</span> <span class="st">&quot;Norte&quot;</span></span>
<span id="cb1796-5"><a href="aed-multivar.html#cb1796-5" aria-hidden="true" tabindex="-1"></a>muni <span class="ot">&lt;-</span> muni[vl, ]</span>
<span id="cb1796-6"><a href="aed-multivar.html#cb1796-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(muni) <span class="ot">&lt;-</span> muni<span class="sc">$</span>Municipio</span>
<span id="cb1796-7"><a href="aed-multivar.html#cb1796-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1796-8"><a href="aed-multivar.html#cb1796-8" aria-hidden="true" tabindex="-1"></a><span class="co"># calcula a distancia geografica entre essas cidades (em graus de latitude)</span></span>
<span id="cb1796-9"><a href="aed-multivar.html#cb1796-9" aria-hidden="true" tabindex="-1"></a>mdist <span class="ot">&lt;-</span> <span class="fu">dist</span>(muni[, <span class="fu">c</span>(<span class="st">&quot;Longitude&quot;</span>, <span class="st">&quot;Latitude&quot;</span>)], <span class="at">method =</span> <span class="st">&quot;euclidean&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1797"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1797-1"><a href="aed-multivar.html#cb1797-1" aria-hidden="true" tabindex="-1"></a><span class="co"># veja o help de hclust e também</span></span>
<span id="cb1797-2"><a href="aed-multivar.html#cb1797-2" aria-hidden="true" tabindex="-1"></a><span class="co"># os diferente métodos de agrupamento</span></span>
<span id="cb1797-3"><a href="aed-multivar.html#cb1797-3" aria-hidden="true" tabindex="-1"></a>?hclust</span></code></pre></div>
<div id="agrupamento-pelo-método-da-mínima-variância" class="section level3 hasAnchor" number="14.4.1">
<h3><span class="header-section-number">14.4.1</span> Agrupamento pelo método da mínima variância<a href="aed-multivar.html#agrupamento-pelo-método-da-mínima-variância" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1798-1"><a href="aed-multivar.html#cb1798-1" aria-hidden="true" tabindex="-1"></a>gp <span class="ot">&lt;-</span> <span class="fu">hclust</span>(mdist, <span class="at">method =</span> <span class="st">&quot;ward.D2&quot;</span>)</span>
<span id="cb1798-2"><a href="aed-multivar.html#cb1798-2" aria-hidden="true" tabindex="-1"></a><span class="co"># visualizando</span></span>
<span id="cb1798-3"><a href="aed-multivar.html#cb1798-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gp, <span class="at">main =</span> <span class="st">&quot;Cidades da região norte&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Distância geográfica (dd)&quot;</span>)</span></code></pre></div>
<p><img src="bot89-introR_files/figure-html/unnamed-chunk-510-1.png" width="672" /></p>
</div>
<div id="agrupamento-por-upgma" class="section level3 hasAnchor" number="14.4.2">
<h3><span class="header-section-number">14.4.2</span> Agrupamento por UPGMA<a href="aed-multivar.html#agrupamento-por-upgma" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1799-1"><a href="aed-multivar.html#cb1799-1" aria-hidden="true" tabindex="-1"></a>gp2 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(mdist, <span class="at">method =</span> <span class="st">&quot;average&quot;</span>)</span>
<span id="cb1799-2"><a href="aed-multivar.html#cb1799-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gp2, <span class="at">hang =</span> <span class="fl">0.1</span>, <span class="at">main =</span> <span class="st">&quot;Cidades da região norte&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Distância geográfica (dd)&quot;</span>)</span></code></pre></div>
<p><img src="bot89-introR_files/figure-html/unnamed-chunk-511-1.png" width="672" /></p>
</div>
<div id="agrupamento-por-centróides" class="section level3 hasAnchor" number="14.4.3">
<h3><span class="header-section-number">14.4.3</span> Agrupamento por centróides<a href="aed-multivar.html#agrupamento-por-centróides" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb1800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1800-1"><a href="aed-multivar.html#cb1800-1" aria-hidden="true" tabindex="-1"></a>gp3 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(mdist, <span class="at">method =</span> <span class="st">&quot;centroid&quot;</span>)</span>
<span id="cb1800-2"><a href="aed-multivar.html#cb1800-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gp3, <span class="at">hang =</span> <span class="fl">0.1</span>, <span class="at">main =</span> <span class="st">&quot;Cidades da região norte&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Distância geográfica (dd)&quot;</span>)</span></code></pre></div>
<p><img src="bot89-introR_files/figure-html/unnamed-chunk-512-1.png" width="672" /></p>
<div class="sourceCode" id="cb1801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1801-1"><a href="aed-multivar.html#cb1801-1" aria-hidden="true" tabindex="-1"></a><span class="co"># teste outros métodos (entenda-os)</span></span></code></pre></div>
<p>Vamos converter nossos objetos <code>gp</code> e <code>gp3</code> para objetos de classe <code>phylo</code>, e gerar um gráfico para cada um.</p>
<div class="sourceCode" id="cb1802"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1802-1"><a href="aed-multivar.html#cb1802-1" aria-hidden="true" tabindex="-1"></a>?plot.phylo</span></code></pre></div>
<div class="sourceCode" id="cb1803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1803-1"><a href="aed-multivar.html#cb1803-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.phylo</span>(gp), <span class="at">type =</span> <span class="st">&quot;phylogram&quot;</span>, <span class="at">label.offset =</span> <span class="fl">0.1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb1803-2"><a href="aed-multivar.html#cb1803-2" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>)</span>
<span id="cb1803-3"><a href="aed-multivar.html#cb1803-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">text =</span> <span class="st">&quot;Distância geográfica&quot;</span>)</span></code></pre></div>
<p><img src="bot89-introR_files/figure-html/unnamed-chunk-514-1.png" width="672" /></p>
<div class="sourceCode" id="cb1804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1804-1"><a href="aed-multivar.html#cb1804-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ou entao, como cladograma, e nao usando o comprimento dos ramos (i.e. as distancias)</span></span>
<span id="cb1804-2"><a href="aed-multivar.html#cb1804-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.phylo</span>(gp), <span class="at">type =</span> <span class="st">&quot;cladogram&quot;</span>, <span class="at">label.offset =</span> <span class="fl">0.1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">use.edge.length =</span> F)</span></code></pre></div>
<p><img src="bot89-introR_files/figure-html/unnamed-chunk-515-1.png" width="672" /></p>
<div class="sourceCode" id="cb1805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1805-1"><a href="aed-multivar.html#cb1805-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ou entao, radial, com distancias</span></span>
<span id="cb1805-2"><a href="aed-multivar.html#cb1805-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.phylo</span>(gp), <span class="at">type =</span> <span class="st">&quot;radial&quot;</span>, <span class="at">label.offset =</span> <span class="fl">0.1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">use.edge.length =</span> T)</span></code></pre></div>
<p><img src="bot89-introR_files/figure-html/unnamed-chunk-516-1.png" width="672" /></p>
<div class="sourceCode" id="cb1806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1806-1"><a href="aed-multivar.html#cb1806-1" aria-hidden="true" tabindex="-1"></a><span class="co"># usando comprimento dos ramos (distancias+relacoes)</span></span>
<span id="cb1806-2"><a href="aed-multivar.html#cb1806-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.phylo</span>(gp), <span class="at">type =</span> <span class="st">&quot;phylogram&quot;</span>, <span class="at">label.offset =</span> <span class="fl">0.1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">use.edge.length =</span> T)</span>
<span id="cb1806-3"><a href="aed-multivar.html#cb1806-3" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>)</span>
<span id="cb1806-4"><a href="aed-multivar.html#cb1806-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="fl">2.5</span>, <span class="at">text =</span> <span class="st">&quot;Distância geográfica&quot;</span>)</span></code></pre></div>
<p><img src="bot89-introR_files/figure-html/unnamed-chunk-517-1.png" width="672" /></p>
<div class="sourceCode" id="cb1807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1807-1"><a href="aed-multivar.html#cb1807-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nao usando o comprimento dos ramos (relacoes apenas)</span></span>
<span id="cb1807-2"><a href="aed-multivar.html#cb1807-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.phylo</span>(gp), <span class="at">type =</span> <span class="st">&quot;phylogram&quot;</span>, <span class="at">label.offset =</span> <span class="fl">0.1</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">use.edge.length =</span> F, <span class="at">edge.color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">edge.width =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="bot89-introR_files/figure-html/unnamed-chunk-518-1.png" width="672" /></p>
</div>
<div id="exemplo-florístico" class="section level3 hasAnchor" number="14.4.4">
<h3><span class="header-section-number">14.4.4</span> Exemplo florístico<a href="aed-multivar.html#exemplo-florístico" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vamos explorar a similaridade florística entre parcelas com os dados de caixetais novamente.</p>
<div class="sourceCode" id="cb1808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1808-1"><a href="aed-multivar.html#cb1808-1" aria-hidden="true" tabindex="-1"></a>caixeta <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;caixeta.csv&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>, <span class="at">header =</span> T, <span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">&quot;NA&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;NULL&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb1809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1809-1"><a href="aed-multivar.html#cb1809-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(caixeta)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
local
</th>
<th style="text-align:right;">
parcela
</th>
<th style="text-align:right;">
arvore
</th>
<th style="text-align:right;">
fuste
</th>
<th style="text-align:right;">
cap
</th>
<th style="text-align:right;">
h
</th>
<th style="text-align:left;">
especie
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
chauas
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
210
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:left;">
Myrcia sulfiflora
</td>
</tr>
<tr>
<td style="text-align:left;">
chauas
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
170
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:left;">
Myrcia sulfiflora
</td>
</tr>
<tr>
<td style="text-align:left;">
chauas
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
720
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:left;">
Syagrus romanzoffianus
</td>
</tr>
<tr>
<td style="text-align:left;">
chauas
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:left;">
Tabebuia cassinoides
</td>
</tr>
<tr>
<td style="text-align:left;">
chauas
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
750
</td>
<td style="text-align:right;">
170
</td>
<td style="text-align:left;">
indet.1
</td>
</tr>
<tr>
<td style="text-align:left;">
chauas
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
320
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:left;">
Myrcia sulfiflora
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1810"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1810-1"><a href="aed-multivar.html#cb1810-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(caixeta)</span></code></pre></div>
<pre><code>## [1] &quot;local&quot;   &quot;parcela&quot; &quot;arvore&quot;  &quot;fuste&quot;   &quot;cap&quot;     &quot;h&quot;       &quot;especie&quot;</code></pre>
<div class="sourceCode" id="cb1812"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1812-1"><a href="aed-multivar.html#cb1812-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vamos visualizar a similaridade florística entre parcelas</span></span>
<span id="cb1812-2"><a href="aed-multivar.html#cb1812-2" aria-hidden="true" tabindex="-1"></a><span class="co"># entao geramos uma tabela de parcela vs. especies</span></span>
<span id="cb1812-3"><a href="aed-multivar.html#cb1812-3" aria-hidden="true" tabindex="-1"></a><span class="co"># primeiro um vetor com valores únicos para local+parcela</span></span>
<span id="cb1812-4"><a href="aed-multivar.html#cb1812-4" aria-hidden="true" tabindex="-1"></a><span class="co"># porque o número da parcela repete entre locais</span></span>
<span id="cb1812-5"><a href="aed-multivar.html#cb1812-5" aria-hidden="true" tabindex="-1"></a>parcelas <span class="ot">&lt;-</span> <span class="fu">paste</span>(caixeta<span class="sc">$</span>local, caixeta<span class="sc">$</span>parcela, <span class="at">sep =</span> <span class="st">&quot;-&quot;</span>)</span>
<span id="cb1812-6"><a href="aed-multivar.html#cb1812-6" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">table</span>(parcelas, <span class="at">especies =</span> caixeta<span class="sc">$</span>especie)</span>
<span id="cb1812-7"><a href="aed-multivar.html#cb1812-7" aria-hidden="true" tabindex="-1"></a>tb[, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Alchornea triplinervia
</th>
<th style="text-align:right;">
Andira fraxinifolia
</th>
<th style="text-align:right;">
bombacaceae
</th>
<th style="text-align:right;">
Cabralea canjerana
</th>
<th style="text-align:right;">
Callophyllum brasiliensis
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
chauas-1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
chauas-2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
chauas-3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
chauas-4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
chauas-5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
jureia-1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
jureia-2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
jureia-3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
jureia-4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
jureia-5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
retiro-1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
retiro-2
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
retiro-3
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
retiro-4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
retiro-5
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1813-1"><a href="aed-multivar.html#cb1813-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(tb)</span></code></pre></div>
<pre><code>## [1] 15 43</code></pre>
<div class="sourceCode" id="cb1815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1815-1"><a href="aed-multivar.html#cb1815-1" aria-hidden="true" tabindex="-1"></a><span class="co"># essa tabela contém o número de indivíduos de cada espécie</span></span>
<span id="cb1815-2"><a href="aed-multivar.html#cb1815-2" aria-hidden="true" tabindex="-1"></a><span class="co"># em cada parcela</span></span>
<span id="cb1815-3"><a href="aed-multivar.html#cb1815-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1815-4"><a href="aed-multivar.html#cb1815-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculando um índice de distancia de Jaccard para dados de presença e ausência</span></span>
<span id="cb1815-5"><a href="aed-multivar.html#cb1815-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1815-6"><a href="aed-multivar.html#cb1815-6" aria-hidden="true" tabindex="-1"></a><span class="co"># transformando em uma tabela de presença e ausencia</span></span>
<span id="cb1815-7"><a href="aed-multivar.html#cb1815-7" aria-hidden="true" tabindex="-1"></a>tb2 <span class="ot">&lt;-</span> tb</span>
<span id="cb1815-8"><a href="aed-multivar.html#cb1815-8" aria-hidden="true" tabindex="-1"></a>tb2[tb2 <span class="sc">&gt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span></code></pre></div>
<p>Vamos utilizar a função <code>vegdist()</code> do pacote <code>vegan</code>.</p>
<div class="sourceCode" id="cb1816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1816-1"><a href="aed-multivar.html#cb1816-1" aria-hidden="true" tabindex="-1"></a>?vegdist</span></code></pre></div>
<div class="sourceCode" id="cb1817"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1817-1"><a href="aed-multivar.html#cb1817-1" aria-hidden="true" tabindex="-1"></a>djac <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(tb2, <span class="at">method =</span> <span class="st">&quot;jaccard&quot;</span>)</span>
<span id="cb1817-2"><a href="aed-multivar.html#cb1817-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(djac)</span></code></pre></div>
<pre><code>## [1] &quot;dist&quot;</code></pre>
<div class="sourceCode" id="cb1819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1819-1"><a href="aed-multivar.html#cb1819-1" aria-hidden="true" tabindex="-1"></a><span class="co"># é uma matriz de distancia entre parcela</span></span>
<span id="cb1819-2"><a href="aed-multivar.html#cb1819-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as.matrix</span>(djac)[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
chauas-1
</th>
<th style="text-align:right;">
chauas-2
</th>
<th style="text-align:right;">
chauas-3
</th>
<th style="text-align:right;">
chauas-4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
chauas-1
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.7500000
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
0.8181818
</td>
</tr>
<tr>
<td style="text-align:left;">
chauas-2
</td>
<td style="text-align:right;">
0.7500000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.5714286
</td>
</tr>
<tr>
<td style="text-align:left;">
chauas-3
</td>
<td style="text-align:right;">
0.8000000
</td>
<td style="text-align:right;">
0.5000000
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.2500000
</td>
</tr>
<tr>
<td style="text-align:left;">
chauas-4
</td>
<td style="text-align:right;">
0.8181818
</td>
<td style="text-align:right;">
0.5714286
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
</tbody>
</table>
<p>Podemos fazer um NMDS com esse resultado:</p>
<div class="sourceCode" id="cb1820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1820-1"><a href="aed-multivar.html#cb1820-1" aria-hidden="true" tabindex="-1"></a>onmds <span class="ot">&lt;-</span> <span class="fu">bestnmds</span>(djac, <span class="at">k =</span> <span class="dv">2</span>)</span>
<span id="cb1820-2"><a href="aed-multivar.html#cb1820-2" aria-hidden="true" tabindex="-1"></a><span class="co"># parcelas 3 e 5 tem exatamente as mesmas espécies</span></span>
<span id="cb1820-3"><a href="aed-multivar.html#cb1820-3" aria-hidden="true" tabindex="-1"></a><span class="co"># vamos com colocar um valor super pequeno para essa distancia (quase zero)</span></span></code></pre></div>
<div class="sourceCode" id="cb1821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1821-1"><a href="aed-multivar.html#cb1821-1" aria-hidden="true" tabindex="-1"></a>djac[djac <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fl">0.0000000000000000001</span></span></code></pre></div>
<div class="sourceCode" id="cb1822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1822-1"><a href="aed-multivar.html#cb1822-1" aria-hidden="true" tabindex="-1"></a><span class="co"># agora funciona</span></span>
<span id="cb1822-2"><a href="aed-multivar.html#cb1822-2" aria-hidden="true" tabindex="-1"></a>onmds <span class="ot">&lt;-</span> <span class="fu">bestnmds</span>(djac, <span class="at">k =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1823-1"><a href="aed-multivar.html#cb1823-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plotando o resultado</span></span>
<span id="cb1823-2"><a href="aed-multivar.html#cb1823-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pega cores e simbolos segundo o local</span></span>
<span id="cb1823-3"><a href="aed-multivar.html#cb1823-3" aria-hidden="true" tabindex="-1"></a>ll <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">local =</span> caixeta<span class="sc">$</span>local, parcelas)</span>
<span id="cb1823-4"><a href="aed-multivar.html#cb1823-4" aria-hidden="true" tabindex="-1"></a>ll <span class="ot">&lt;-</span> <span class="fu">unique</span>(ll)</span>
<span id="cb1823-5"><a href="aed-multivar.html#cb1823-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ll) <span class="ot">&lt;-</span> ll<span class="sc">$</span>parcelas</span>
<span id="cb1823-6"><a href="aed-multivar.html#cb1823-6" aria-hidden="true" tabindex="-1"></a>ll</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
local
</th>
<th style="text-align:left;">
parcelas
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
chauas-1
</td>
<td style="text-align:left;">
chauas
</td>
<td style="text-align:left;">
chauas-1
</td>
</tr>
<tr>
<td style="text-align:left;">
chauas-2
</td>
<td style="text-align:left;">
chauas
</td>
<td style="text-align:left;">
chauas-2
</td>
</tr>
<tr>
<td style="text-align:left;">
chauas-3
</td>
<td style="text-align:left;">
chauas
</td>
<td style="text-align:left;">
chauas-3
</td>
</tr>
<tr>
<td style="text-align:left;">
chauas-4
</td>
<td style="text-align:left;">
chauas
</td>
<td style="text-align:left;">
chauas-4
</td>
</tr>
<tr>
<td style="text-align:left;">
chauas-5
</td>
<td style="text-align:left;">
chauas
</td>
<td style="text-align:left;">
chauas-5
</td>
</tr>
<tr>
<td style="text-align:left;">
jureia-1
</td>
<td style="text-align:left;">
jureia
</td>
<td style="text-align:left;">
jureia-1
</td>
</tr>
<tr>
<td style="text-align:left;">
jureia-2
</td>
<td style="text-align:left;">
jureia
</td>
<td style="text-align:left;">
jureia-2
</td>
</tr>
<tr>
<td style="text-align:left;">
jureia-3
</td>
<td style="text-align:left;">
jureia
</td>
<td style="text-align:left;">
jureia-3
</td>
</tr>
<tr>
<td style="text-align:left;">
jureia-4
</td>
<td style="text-align:left;">
jureia
</td>
<td style="text-align:left;">
jureia-4
</td>
</tr>
<tr>
<td style="text-align:left;">
jureia-5
</td>
<td style="text-align:left;">
jureia
</td>
<td style="text-align:left;">
jureia-5
</td>
</tr>
<tr>
<td style="text-align:left;">
retiro-1
</td>
<td style="text-align:left;">
retiro
</td>
<td style="text-align:left;">
retiro-1
</td>
</tr>
<tr>
<td style="text-align:left;">
retiro-2
</td>
<td style="text-align:left;">
retiro
</td>
<td style="text-align:left;">
retiro-2
</td>
</tr>
<tr>
<td style="text-align:left;">
retiro-3
</td>
<td style="text-align:left;">
retiro
</td>
<td style="text-align:left;">
retiro-3
</td>
</tr>
<tr>
<td style="text-align:left;">
retiro-4
</td>
<td style="text-align:left;">
retiro
</td>
<td style="text-align:left;">
retiro-4
</td>
</tr>
<tr>
<td style="text-align:left;">
retiro-5
</td>
<td style="text-align:left;">
retiro
</td>
<td style="text-align:left;">
retiro-5
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1824-1"><a href="aed-multivar.html#cb1824-1" aria-hidden="true" tabindex="-1"></a>rn <span class="ot">&lt;-</span> <span class="fu">rownames</span>(<span class="fu">as.matrix</span>(tb2))</span>
<span id="cb1824-2"><a href="aed-multivar.html#cb1824-2" aria-hidden="true" tabindex="-1"></a>locais <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(ll[rn, <span class="st">&quot;local&quot;</span>])</span>
<span id="cb1824-3"><a href="aed-multivar.html#cb1824-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1824-4"><a href="aed-multivar.html#cb1824-4" aria-hidden="true" tabindex="-1"></a>cores <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>)[<span class="fu">as.numeric</span>(locais)]</span>
<span id="cb1824-5"><a href="aed-multivar.html#cb1824-5" aria-hidden="true" tabindex="-1"></a>pchs <span class="ot">&lt;-</span> (<span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>)[<span class="fu">as.numeric</span>(locais)]</span>
<span id="cb1824-6"><a href="aed-multivar.html#cb1824-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(onmds<span class="sc">$</span>points, <span class="at">pch =</span> pchs, <span class="at">bg =</span> cores, <span class="at">xlab =</span> <span class="st">&quot;NMDS1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;NMDS2&quot;</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb1824-7"><a href="aed-multivar.html#cb1824-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">levels</span>(locais), <span class="at">pch =</span> <span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>, <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">inset =</span> <span class="fl">0.05</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">pt.cex =</span> <span class="fl">1.5</span>, <span class="at">y.intersp =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="bot89-introR_files/figure-html/unnamed-chunk-529-1.png" width="672" /></p>
<p>Agora vamos visualizar o resultado na forma de um agrupamento:</p>
<div class="sourceCode" id="cb1825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1825-1"><a href="aed-multivar.html#cb1825-1" aria-hidden="true" tabindex="-1"></a>cluster <span class="ot">&lt;-</span> <span class="fu">hclust</span>(djac, <span class="at">method =</span> <span class="st">&quot;ward.D2&quot;</span>)</span>
<span id="cb1825-2"><a href="aed-multivar.html#cb1825-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cluster, <span class="at">ylab =</span> <span class="st">&quot;Dissimilaridade Florística (Jaccard)&quot;</span>)</span></code></pre></div>
<p><img src="bot89-introR_files/figure-html/unnamed-chunk-530-1.png" width="672" /></p>
<p>Para aprimorar a figura, vamos utilizar a função <code>as.phylo()</code> do pacote <code>ape</code> <span class="citation">(<a href="#ref-R-ape" role="doc-biblioref">Paradis et al. 2020</a>)</span> para converter o objeto <code>cluster</code> de classe <code>dendrogram</code> para um de classe <code>phylo</code>.</p>
<div class="sourceCode" id="cb1826"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1826-1"><a href="aed-multivar.html#cb1826-1" aria-hidden="true" tabindex="-1"></a>pcl <span class="ot">&lt;-</span> <span class="fu">as.phylo</span>(cluster)</span>
<span id="cb1826-2"><a href="aed-multivar.html#cb1826-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb1826-3"><a href="aed-multivar.html#cb1826-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pcl, <span class="at">tip.color =</span> cores, <span class="at">label.offset =</span> <span class="fl">0.02</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb1826-4"><a href="aed-multivar.html#cb1826-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pontos</span></span>
<span id="cb1826-5"><a href="aed-multivar.html#cb1826-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tiplabels</span>(<span class="at">pch =</span> <span class="dv">21</span>, <span class="at">frame =</span> <span class="cn">NULL</span>, <span class="at">bg =</span> cores)</span>
<span id="cb1826-6"><a href="aed-multivar.html#cb1826-6" aria-hidden="true" tabindex="-1"></a><span class="co"># eixo</span></span>
<span id="cb1826-7"><a href="aed-multivar.html#cb1826-7" aria-hidden="true" tabindex="-1"></a><span class="fu">axisPhylo</span>()</span>
<span id="cb1826-8"><a href="aed-multivar.html#cb1826-8" aria-hidden="true" tabindex="-1"></a><span class="co"># nome do eixo</span></span>
<span id="cb1826-9"><a href="aed-multivar.html#cb1826-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">text =</span> <span class="st">&quot;Jaccard índice (0 ou 1)&quot;</span>, <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="fl">2.5</span>)</span>
<span id="cb1826-10"><a href="aed-multivar.html#cb1826-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">levels</span>(locais), <span class="at">pch =</span> <span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>, <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">inset =</span> <span class="fl">0.01</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">pt.cex =</span> <span class="fl">1.5</span>, <span class="at">y.intersp =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p>Vamos repetir essa operação considerando a abundância de espécies por parcelas contidos no objeto <code>tb</code> (usamos o índice de Sorensen).</p>
<div class="sourceCode" id="cb1827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1827-1"><a href="aed-multivar.html#cb1827-1" aria-hidden="true" tabindex="-1"></a>tb[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Alchornea triplinervia
</th>
<th style="text-align:right;">
Andira fraxinifolia
</th>
<th style="text-align:right;">
bombacaceae
</th>
<th style="text-align:right;">
Cabralea canjerana
</th>
<th style="text-align:right;">
Callophyllum brasiliensis
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
chauas-1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
chauas-2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
chauas-3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
chauas-4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1828-1"><a href="aed-multivar.html#cb1828-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sorensen (bray na convencao do R)</span></span>
<span id="cb1828-2"><a href="aed-multivar.html#cb1828-2" aria-hidden="true" tabindex="-1"></a>dsor <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(tb, <span class="at">method =</span> <span class="st">&quot;bray&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb1829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1829-1"><a href="aed-multivar.html#cb1829-1" aria-hidden="true" tabindex="-1"></a>onmds2 <span class="ot">&lt;-</span> <span class="fu">bestnmds</span>(dsor, <span class="at">k =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>Plota o NMDS:</p>
<div class="sourceCode" id="cb1830"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1830-1"><a href="aed-multivar.html#cb1830-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(onmds2<span class="sc">$</span>points, <span class="at">pch =</span> pchs, <span class="at">bg =</span> cores, <span class="at">xlab =</span> <span class="st">&quot;NMDS1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;NMDS2&quot;</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb1830-2"><a href="aed-multivar.html#cb1830-2" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">levels</span>(locais), <span class="at">pch =</span> <span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>, <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">inset =</span> <span class="fl">0.05</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">pt.cex =</span> <span class="fl">1.5</span>, <span class="at">y.intersp =</span> <span class="fl">1.5</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="bot89-introR_files/figure-html/unnamed-chunk-536-1.png" width="672" /></p>
<p>Agora, vamos plotar o agrupamento:</p>
<div class="sourceCode" id="cb1831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1831-1"><a href="aed-multivar.html#cb1831-1" aria-hidden="true" tabindex="-1"></a>cluster2 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(dsor, <span class="at">method =</span> <span class="st">&quot;ward.D2&quot;</span>)</span>
<span id="cb1831-2"><a href="aed-multivar.html#cb1831-2" aria-hidden="true" tabindex="-1"></a>pcl2 <span class="ot">&lt;-</span> <span class="fu">as.phylo</span>(cluster2)</span>
<span id="cb1831-3"><a href="aed-multivar.html#cb1831-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb1831-4"><a href="aed-multivar.html#cb1831-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pcl2, <span class="at">tip.color =</span> cores, <span class="at">label.offset =</span> <span class="fl">0.02</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb1831-5"><a href="aed-multivar.html#cb1831-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tiplabels</span>(<span class="at">pch =</span> <span class="dv">21</span>, <span class="at">frame =</span> <span class="cn">NULL</span>, <span class="at">bg =</span> cores)</span>
<span id="cb1831-6"><a href="aed-multivar.html#cb1831-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axisPhylo</span>()</span>
<span id="cb1831-7"><a href="aed-multivar.html#cb1831-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">text =</span> <span class="st">&quot;Sorensen índice (com abundância)&quot;</span>, <span class="at">side =</span> <span class="dv">1</span>, <span class="at">line =</span> <span class="fl">2.5</span>)</span>
<span id="cb1831-8"><a href="aed-multivar.html#cb1831-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">levels</span>(locais), <span class="at">pch =</span> <span class="dv">21</span><span class="sc">:</span><span class="dv">23</span>, <span class="at">pt.bg =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">inset =</span> <span class="fl">0.01</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">pt.cex =</span> <span class="fl">1.5</span>, <span class="at">y.intersp =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="bot89-introR_files/figure-html/unnamed-chunk-537-1.png" width="672" /></p>
</div>
<div id="análise-de-coordenadas-principais-pcoa" class="section level3 hasAnchor" number="14.4.5">
<h3><span class="header-section-number">14.4.5</span> Análise de Coordenadas Principais (PCoA)<a href="aed-multivar.html#análise-de-coordenadas-principais-pcoa" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A função <code>capscale()</code>faz uma análise de coordenadas principais (ou escalonamento multidimensional métrico ou clássico).
É parecida com uma Análise de Componentes Principais (PCA), mas é baseada em matrizes de distância.
Indica os efeitos das variáveis (parâmetro ‘’species’’) sobre os eixos.
Já a função <code>ordiplot()</code> do pacote <code>vegan</code> <span class="citation">(<a href="#ref-R-vegan" role="doc-biblioref">Oksanen et al. 2020</a>)</span> permite graficar uma ordenação e os efeitos das variáveis (<code>sites</code> vs. <code>species</code>).</p>
<p>Leiam aqui uma <a href="http://occamstypewriter.org/boboh/2012/01/17/pca_and_pcoa_explained/">comparação entre PCA e PCoA</a></p>
<div class="sourceCode" id="cb1832"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1832-1"><a href="aed-multivar.html#cb1832-1" aria-hidden="true" tabindex="-1"></a><span class="co"># análise de coordenadas principais</span></span>
<span id="cb1832-2"><a href="aed-multivar.html#cb1832-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris) <span class="co"># carrega o conjunto de dados iris</span></span>
<span id="cb1832-3"><a href="aed-multivar.html#cb1832-3" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb1832-4"><a href="aed-multivar.html#cb1832-4" aria-hidden="true" tabindex="-1"></a>mypcoa <span class="ot">&lt;-</span> <span class="fu">capscale</span>(dt <span class="sc">~</span> <span class="dv">1</span>, <span class="at">distance =</span> <span class="st">&quot;gower&quot;</span>, <span class="at">add =</span> F)</span>
<span id="cb1832-5"><a href="aed-multivar.html#cb1832-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1832-6"><a href="aed-multivar.html#cb1832-6" aria-hidden="true" tabindex="-1"></a><span class="co"># quando da variação está explicado pelos eixos</span></span>
<span id="cb1832-7"><a href="aed-multivar.html#cb1832-7" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> <span class="fu">summary</span>(mypcoa)</span>
<span id="cb1832-8"><a href="aed-multivar.html#cb1832-8" aria-hidden="true" tabindex="-1"></a>var.expl <span class="ot">&lt;-</span> resumo<span class="sc">$</span>cont<span class="sc">$</span>importance</span>
<span id="cb1832-9"><a href="aed-multivar.html#cb1832-9" aria-hidden="true" tabindex="-1"></a><span class="co"># veja a proporção cumulativa dos primeiros cinco eixos</span></span>
<span id="cb1832-10"><a href="aed-multivar.html#cb1832-10" aria-hidden="true" tabindex="-1"></a>var.expl[<span class="st">&quot;Cumulative Proportion&quot;</span>, ][<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>##      MDS1      MDS2      MDS3      MDS4      MDS5 
## 0.7468617 0.8614730 0.8946967 0.9148675 0.9289785</code></pre>
<div class="sourceCode" id="cb1834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1834-1"><a href="aed-multivar.html#cb1834-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pega a proporção explicada por cada eixo</span></span>
<span id="cb1834-2"><a href="aed-multivar.html#cb1834-2" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> var.expl[<span class="st">&quot;Proportion Explained&quot;</span>, ][<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb1834-3"><a href="aed-multivar.html#cb1834-3" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> tt <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb1834-4"><a href="aed-multivar.html#cb1834-4" aria-hidden="true" tabindex="-1"></a><span class="co"># gera um gráfico de barras com isso</span></span>
<span id="cb1834-5"><a href="aed-multivar.html#cb1834-5" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(tt, <span class="at">xlab =</span> <span class="st">&quot;Eixos MDS&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Variação explicada %&quot;</span>)</span></code></pre></div>
<p><img src="bot89-introR_files/figure-html/unnamed-chunk-538-1.png" width="672" /></p>
<div class="sourceCode" id="cb1835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1835-1"><a href="aed-multivar.html#cb1835-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fazendo uma figura com ordiplot</span></span>
<span id="cb1835-2"><a href="aed-multivar.html#cb1835-2" aria-hidden="true" tabindex="-1"></a><span class="co"># veja o help</span></span>
<span id="cb1835-3"><a href="aed-multivar.html#cb1835-3" aria-hidden="true" tabindex="-1"></a>?ordiplot</span></code></pre></div>
<div class="sourceCode" id="cb1836"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1836-1"><a href="aed-multivar.html#cb1836-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define cor e simbolo por especie</span></span>
<span id="cb1836-2"><a href="aed-multivar.html#cb1836-2" aria-hidden="true" tabindex="-1"></a>tx <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(iris<span class="sc">$</span>Species)</span>
<span id="cb1836-3"><a href="aed-multivar.html#cb1836-3" aria-hidden="true" tabindex="-1"></a><span class="co"># simbolos para os níveis</span></span>
<span id="cb1836-4"><a href="aed-multivar.html#cb1836-4" aria-hidden="true" tabindex="-1"></a>upchs <span class="ot">&lt;-</span> <span class="dv">21</span><span class="sc">:</span><span class="dv">23</span></span>
<span id="cb1836-5"><a href="aed-multivar.html#cb1836-5" aria-hidden="true" tabindex="-1"></a><span class="co"># cores para os níveis</span></span>
<span id="cb1836-6"><a href="aed-multivar.html#cb1836-6" aria-hidden="true" tabindex="-1"></a>cores <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(<span class="fu">levels</span>(tx)), <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb1836-7"><a href="aed-multivar.html#cb1836-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1836-8"><a href="aed-multivar.html#cb1836-8" aria-hidden="true" tabindex="-1"></a><span class="co"># gera a figura</span></span>
<span id="cb1836-9"><a href="aed-multivar.html#cb1836-9" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">ordiplot</span>(mypcoa, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb1836-10"><a href="aed-multivar.html#cb1836-10" aria-hidden="true" tabindex="-1"></a><span class="co"># adiciona os pontos de cada linha</span></span>
<span id="cb1836-11"><a href="aed-multivar.html#cb1836-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(fig, <span class="st">&quot;sites&quot;</span>, <span class="at">pch =</span> upchs[<span class="fu">as.numeric</span>(tx)], <span class="at">bg =</span> cores[<span class="fu">as.numeric</span>(tx)], <span class="at">col =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb1836-12"><a href="aed-multivar.html#cb1836-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1836-13"><a href="aed-multivar.html#cb1836-13" aria-hidden="true" tabindex="-1"></a><span class="co"># pega os scores das variáveis</span></span>
<span id="cb1836-14"><a href="aed-multivar.html#cb1836-14" aria-hidden="true" tabindex="-1"></a><span class="co"># que mostram os efeitos das variáveis usadas</span></span>
<span id="cb1836-15"><a href="aed-multivar.html#cb1836-15" aria-hidden="true" tabindex="-1"></a>mls <span class="ot">&lt;-</span> <span class="fu">scores</span>(mypcoa, <span class="at">display =</span> <span class="st">&quot;species&quot;</span>)</span>
<span id="cb1836-16"><a href="aed-multivar.html#cb1836-16" aria-hidden="true" tabindex="-1"></a>mls</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
MDS1
</th>
<th style="text-align:right;">
MDS2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Sepal.Length
</td>
<td style="text-align:right;">
2.0020165
</td>
<td style="text-align:right;">
-1.1230766
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Width
</td>
<td style="text-align:right;">
-0.4980034
</td>
<td style="text-align:right;">
-1.8451477
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Length
</td>
<td style="text-align:right;">
4.7366457
</td>
<td style="text-align:right;">
0.1241131
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width
</td>
<td style="text-align:right;">
2.0004259
</td>
<td style="text-align:right;">
-0.1699399
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1837"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1837-1"><a href="aed-multivar.html#cb1837-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plota flechas para esses efeitos</span></span>
<span id="cb1837-2"><a href="aed-multivar.html#cb1837-2" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="dv">0</span>, <span class="dv">0</span>, mls[, <span class="dv">1</span>] <span class="sc">*</span> <span class="fl">0.8</span>, mls[, <span class="dv">2</span>] <span class="sc">*</span> <span class="fl">0.8</span>, <span class="at">length =</span> <span class="fl">0.05</span>, <span class="at">angle =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1837-3"><a href="aed-multivar.html#cb1837-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(mls[, <span class="dv">1</span>] <span class="sc">*</span> <span class="fl">0.8</span>, mls[, <span class="dv">2</span>] <span class="sc">*</span> <span class="fl">0.8</span>, <span class="at">labels =</span> <span class="fu">rownames</span>(mls), <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">pos =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="bot89-introR_files/figure-html/unnamed-chunk-540-1.png" width="672" /></p>
</div>
</div>
<div id="componentes-principais-pca" class="section level2 hasAnchor" number="14.5">
<h2><span class="header-section-number">14.5</span> Componentes Principais (PCA)<a href="aed-multivar.html#componentes-principais-pca" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://pt.wikipedia.org/wiki/An%C3%A1lise_de_componentes_principais">Análise de Componentes Principais (PCA)</a> é o método mais conhecido de ordenação, mas diferentemente dos métodos que se baseiam em matrizes de distância (ver abaixo) que são mais flexíveis e menos exigentes quanto à premissas estatísticas, a ordenação com PCA tem as seguintes limitações:</p>
<ul>
<li><p>Os componentes principais são independentes apenas se os dados possuirem <strong>distribuição normal conjuntamente</strong>;</p></li>
<li><p>A PCA é sensível à escala relativa das variáveis originais.</p></li>
</ul>
<p>Um exemplo:</p>
<div class="sourceCode" id="cb1838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1838-1"><a href="aed-multivar.html#cb1838-1" aria-hidden="true" tabindex="-1"></a><span class="co"># análise de componentes principais</span></span>
<span id="cb1838-2"><a href="aed-multivar.html#cb1838-2" aria-hidden="true" tabindex="-1"></a>?prcomp</span></code></pre></div>
<div class="sourceCode" id="cb1839"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1839-1"><a href="aed-multivar.html#cb1839-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris) <span class="co"># carrega o conjunto de dados iris para a rea de trabalho</span></span>
<span id="cb1839-2"><a href="aed-multivar.html#cb1839-2" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> iris[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span></code></pre></div>
<div class="sourceCode" id="cb1840"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1840-1"><a href="aed-multivar.html#cb1840-1" aria-hidden="true" tabindex="-1"></a>meu.pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(dt, <span class="at">scale. =</span> T, <span class="at">tol =</span> <span class="dv">0</span>, <span class="at">retx =</span> T)</span>
<span id="cb1840-2"><a href="aed-multivar.html#cb1840-2" aria-hidden="true" tabindex="-1"></a><span class="co"># entenda os argumentos usados</span></span>
<span id="cb1840-3"><a href="aed-multivar.html#cb1840-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1840-4"><a href="aed-multivar.html#cb1840-4" aria-hidden="true" tabindex="-1"></a><span class="co"># classe gerada</span></span>
<span id="cb1840-5"><a href="aed-multivar.html#cb1840-5" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(meu.pca)</span></code></pre></div>
<pre><code>## [1] &quot;prcomp&quot;</code></pre>
<div class="sourceCode" id="cb1842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1842-1"><a href="aed-multivar.html#cb1842-1" aria-hidden="true" tabindex="-1"></a><span class="co"># elementos do resultado</span></span>
<span id="cb1842-2"><a href="aed-multivar.html#cb1842-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(meu.pca)</span></code></pre></div>
<pre><code>## [1] &quot;sdev&quot;     &quot;rotation&quot; &quot;center&quot;   &quot;scale&quot;    &quot;x&quot;</code></pre>
<p>Vamos fazer uma figura utilizando a função <code>ordiplot()</code> do pacote <code>vegan</code>:</p>
<div class="sourceCode" id="cb1844"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1844-1"><a href="aed-multivar.html#cb1844-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fazendo uma figura com ordiplot</span></span>
<span id="cb1844-2"><a href="aed-multivar.html#cb1844-2" aria-hidden="true" tabindex="-1"></a><span class="co"># veja o help</span></span>
<span id="cb1844-3"><a href="aed-multivar.html#cb1844-3" aria-hidden="true" tabindex="-1"></a>?ordiplot</span></code></pre></div>
<div class="sourceCode" id="cb1845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1845-1"><a href="aed-multivar.html#cb1845-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quando da variação está explicado pelos eixos</span></span>
<span id="cb1845-2"><a href="aed-multivar.html#cb1845-2" aria-hidden="true" tabindex="-1"></a>resumo <span class="ot">&lt;-</span> <span class="fu">summary</span>(meu.pca)</span>
<span id="cb1845-3"><a href="aed-multivar.html#cb1845-3" aria-hidden="true" tabindex="-1"></a>var.expl <span class="ot">&lt;-</span> resumo<span class="sc">$</span>importance</span>
<span id="cb1845-4"><a href="aed-multivar.html#cb1845-4" aria-hidden="true" tabindex="-1"></a><span class="co"># veja a proporção cumulativa dos eixos gerados</span></span>
<span id="cb1845-5"><a href="aed-multivar.html#cb1845-5" aria-hidden="true" tabindex="-1"></a>var.expl[<span class="st">&quot;Cumulative Proportion&quot;</span>, ]</span></code></pre></div>
<pre><code>##     PC1     PC2     PC3     PC4 
## 0.72962 0.95813 0.99482 1.00000</code></pre>
<div class="sourceCode" id="cb1847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1847-1"><a href="aed-multivar.html#cb1847-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quatro eixos explicam 100% da variacao</span></span>
<span id="cb1847-2"><a href="aed-multivar.html#cb1847-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pega a proporção explicada por cada eixo</span></span>
<span id="cb1847-3"><a href="aed-multivar.html#cb1847-3" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> var.expl[<span class="st">&quot;Proportion of Variance&quot;</span>, ]</span>
<span id="cb1847-4"><a href="aed-multivar.html#cb1847-4" aria-hidden="true" tabindex="-1"></a>tt <span class="ot">&lt;-</span> tt <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb1847-5"><a href="aed-multivar.html#cb1847-5" aria-hidden="true" tabindex="-1"></a><span class="co"># gera um gráfico de barras com isso</span></span>
<span id="cb1847-6"><a href="aed-multivar.html#cb1847-6" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(tt, <span class="at">xlab =</span> <span class="st">&quot;Eixos PCA&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Variação explicada %&quot;</span>)</span></code></pre></div>
<p><img src="bot89-introR_files/figure-html/unnamed-chunk-545-1.png" width="672" /></p>
<div class="sourceCode" id="cb1848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1848-1"><a href="aed-multivar.html#cb1848-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define cor e simbolo por especie</span></span>
<span id="cb1848-2"><a href="aed-multivar.html#cb1848-2" aria-hidden="true" tabindex="-1"></a>tx <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(iris<span class="sc">$</span>Species)</span>
<span id="cb1848-3"><a href="aed-multivar.html#cb1848-3" aria-hidden="true" tabindex="-1"></a><span class="co"># simbolos para os níveis</span></span>
<span id="cb1848-4"><a href="aed-multivar.html#cb1848-4" aria-hidden="true" tabindex="-1"></a>upchs <span class="ot">&lt;-</span> <span class="dv">21</span><span class="sc">:</span><span class="dv">23</span></span>
<span id="cb1848-5"><a href="aed-multivar.html#cb1848-5" aria-hidden="true" tabindex="-1"></a><span class="co"># cores para os níveis</span></span>
<span id="cb1848-6"><a href="aed-multivar.html#cb1848-6" aria-hidden="true" tabindex="-1"></a>cores <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(<span class="fu">levels</span>(tx)), <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb1848-7"><a href="aed-multivar.html#cb1848-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1848-8"><a href="aed-multivar.html#cb1848-8" aria-hidden="true" tabindex="-1"></a><span class="co"># gera a figura</span></span>
<span id="cb1848-9"><a href="aed-multivar.html#cb1848-9" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">ordiplot</span>(meu.pca, <span class="at">type =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb1848-10"><a href="aed-multivar.html#cb1848-10" aria-hidden="true" tabindex="-1"></a><span class="co"># adiciona os pontos de cada linha</span></span>
<span id="cb1848-11"><a href="aed-multivar.html#cb1848-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(fig, <span class="st">&quot;sites&quot;</span>, <span class="at">pch =</span> upchs[<span class="fu">as.numeric</span>(tx)], <span class="at">bg =</span> cores[<span class="fu">as.numeric</span>(tx)], <span class="at">col =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb1848-12"><a href="aed-multivar.html#cb1848-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1848-13"><a href="aed-multivar.html#cb1848-13" aria-hidden="true" tabindex="-1"></a><span class="co"># pega os scores das variaveis</span></span>
<span id="cb1848-14"><a href="aed-multivar.html#cb1848-14" aria-hidden="true" tabindex="-1"></a><span class="co"># que mostram os efeitos das variáveis usadas</span></span>
<span id="cb1848-15"><a href="aed-multivar.html#cb1848-15" aria-hidden="true" tabindex="-1"></a>mls <span class="ot">&lt;-</span> <span class="fu">scores</span>(meu.pca, <span class="at">display =</span> <span class="st">&quot;species&quot;</span>)</span>
<span id="cb1848-16"><a href="aed-multivar.html#cb1848-16" aria-hidden="true" tabindex="-1"></a>mls</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
PC1
</th>
<th style="text-align:right;">
PC2
</th>
<th style="text-align:right;">
PC3
</th>
<th style="text-align:right;">
PC4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Sepal.Length
</td>
<td style="text-align:right;">
0.5210659
</td>
<td style="text-align:right;">
-0.3774176
</td>
<td style="text-align:right;">
0.7195664
</td>
<td style="text-align:right;">
0.2612863
</td>
</tr>
<tr>
<td style="text-align:left;">
Sepal.Width
</td>
<td style="text-align:right;">
-0.2693474
</td>
<td style="text-align:right;">
-0.9232957
</td>
<td style="text-align:right;">
-0.2443818
</td>
<td style="text-align:right;">
-0.1235096
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Length
</td>
<td style="text-align:right;">
0.5804131
</td>
<td style="text-align:right;">
-0.0244916
</td>
<td style="text-align:right;">
-0.1421264
</td>
<td style="text-align:right;">
-0.8014492
</td>
</tr>
<tr>
<td style="text-align:left;">
Petal.Width
</td>
<td style="text-align:right;">
0.5648565
</td>
<td style="text-align:right;">
-0.0669420
</td>
<td style="text-align:right;">
-0.6342727
</td>
<td style="text-align:right;">
0.5235971
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1849-1"><a href="aed-multivar.html#cb1849-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plota flexas para esses efeitos</span></span>
<span id="cb1849-2"><a href="aed-multivar.html#cb1849-2" aria-hidden="true" tabindex="-1"></a>ft <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># para aumentar as flexas um pouco</span></span>
<span id="cb1849-3"><a href="aed-multivar.html#cb1849-3" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="dv">0</span>, <span class="dv">0</span>, mls[, <span class="dv">1</span>] <span class="sc">*</span> ft, mls[, <span class="dv">2</span>] <span class="sc">*</span> ft, <span class="at">length =</span> <span class="fl">0.05</span>, <span class="at">angle =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1849-4"><a href="aed-multivar.html#cb1849-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(mls[, <span class="dv">1</span>] <span class="sc">*</span> ft, mls[, <span class="dv">2</span>] <span class="sc">*</span> ft, <span class="at">labels =</span> <span class="fu">rownames</span>(mls), <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">pos =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="bot89-introR_files/figure-html/unnamed-chunk-545-2.png" width="672" /></p>

</div>
</div>



<h3>Referências<a href="referências.html#referências" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-R-vegan" class="csl-entry">
Oksanen, Jari, F. Guillaume Blanchet, Michael Friendly, Roeland Kindt, Pierre Legendre, Dan McGlinn, Peter R. Minchin, et al. 2020. <em>vegan: Community Ecology Package</em>. <a href="https://CRAN.R-project.org/package=vegan">https://CRAN.R-project.org/package=vegan</a>.
</div>
<div id="ref-R-ape" class="csl-entry">
Paradis, Emmanuel, Simon Blomberg, Ben Bolker, Joseph Brown, Santiago Claramunt, Julien Claude, Hoa Sien Cuong, et al. 2020. <em>ape: Analyses of Phylogenetics and Evolution</em>. <a href="http://ape-package.ird.fr/">http://ape-package.ird.fr/</a>.
</div>
<div id="ref-R-labdsv" class="csl-entry">
Roberts, David W. 2019. <em>labdsv: Ordination and Multivariate Analysis for Ecology</em>. <a href="http://ecology.msu.montana.edu/labdsv/R">http://ecology.msu.montana.edu/labdsv/R</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="aed-bivar.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="base-tidyverse.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/LABOTAM/LABOTAM.github.io/edit/main/14-aed_checamultivar.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/LABOTAM/IntroR/edit/main/14-aed_checamultivar.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
